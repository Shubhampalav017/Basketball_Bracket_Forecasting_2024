<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Files we are interested in:</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="basketball-bracket-forecasting-2024ml_files/libs/clipboard/clipboard.min.js"></script>
<script src="basketball-bracket-forecasting-2024ml_files/libs/quarto-html/quarto.js"></script>
<script src="basketball-bracket-forecasting-2024ml_files/libs/quarto-html/popper.min.js"></script>
<script src="basketball-bracket-forecasting-2024ml_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="basketball-bracket-forecasting-2024ml_files/libs/quarto-html/anchor.min.js"></script>
<link href="basketball-bracket-forecasting-2024ml_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="basketball-bracket-forecasting-2024ml_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="basketball-bracket-forecasting-2024ml_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="basketball-bracket-forecasting-2024ml_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="basketball-bracket-forecasting-2024ml_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Files we are interested in:</strong></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:44.480910Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:44.480451Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:47.781720Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:47.780185Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:44.480875Z&quot;}" data-papermill="{&quot;duration&quot;:1.759398,&quot;end_time&quot;:&quot;2024-06-05T15:38:40.279097&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-06-05T15:38:38.519699&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-trusted="true" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Circle, Rectangle, Arc</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, log_loss</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GroupKFold</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"fivethirtyeight"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>mypal <span class="op">=</span> plt.rcParams[<span class="st">"axes.prop_cycle"</span>].by_key()[<span class="st">"color"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:47.785547Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:47.784843Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:48.959357Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:48.957800Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:47.785502Z&quot;}" data-papermill="{&quot;duration&quot;:1.09813,&quot;end_time&quot;:&quot;2024-06-05T15:38:41.381109&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-06-05T15:38:40.282979&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-trusted="true" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">-</span>GFlash ..<span class="op">/</span><span class="bu">input</span><span class="op">/</span>march<span class="op">-</span>machine<span class="op">-</span>learning<span class="op">-</span>mania<span class="op">-</span><span class="dv">2024</span><span class="op">/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total 144M
   0 drwxr-xr-x 2 nobody    0 May 13 08:49 ./
4.0K drwxr-xr-x 3 root   4.0K Jun 12 12:38 ../
4.0K -rw-r--r-- 1 nobody 1.4K May 13 08:49 2024_tourney_seeds.csv
 12K -rw-r--r-- 1 nobody 9.1K May 13 08:49 Cities.csv
4.0K -rw-r--r-- 1 nobody 1.7K May 13 08:49 Conferences.csv
168K -rw-r--r-- 1 nobody 168K May 13 08:49 MConferenceTourneyGames.csv
2.5M -rw-r--r-- 1 nobody 2.5M May 13 08:49 MGameCities.csv
111M -rw-r--r-- 1 nobody 111M May 13 08:49 MMasseyOrdinals_thruSeason2024_day128.csv
 72K -rw-r--r-- 1 nobody  72K May 13 08:49 MNCAATourneyCompactResults.csv
132K -rw-r--r-- 1 nobody 129K May 13 08:49 MNCAATourneyDetailedResults.csv
 16K -rw-r--r-- 1 nobody  16K May 13 08:49 MNCAATourneySeedRoundSlots.csv
 40K -rw-r--r-- 1 nobody  38K May 13 08:49 MNCAATourneySeeds.csv
 52K -rw-r--r-- 1 nobody  50K May 13 08:49 MNCAATourneySlots.csv
5.3M -rw-r--r-- 1 nobody 5.3M May 13 08:49 MRegularSeasonCompactResults.csv
 11M -rw-r--r-- 1 nobody  11M May 13 08:49 MRegularSeasonDetailedResults.csv
4.0K -rw-r--r-- 1 nobody 1.8K May 13 08:49 MSeasons.csv
 60K -rw-r--r-- 1 nobody  59K May 13 08:49 MSecondaryTourneyCompactResults.csv
 28K -rw-r--r-- 1 nobody  27K May 13 08:49 MSecondaryTourneyTeams.csv
388K -rw-r--r-- 1 nobody 385K May 13 08:49 MTeamCoaches.csv
220K -rw-r--r-- 1 nobody 220K May 13 08:49 MTeamConferences.csv
 24K -rw-r--r-- 1 nobody  23K May 13 08:49 MTeamSpellings.csv
 12K -rw-r--r-- 1 nobody 9.8K May 13 08:49 MTeams.csv
2.4M -rw-r--r-- 1 nobody 2.4M May 13 08:49 WGameCities.csv
 48K -rw-r--r-- 1 nobody  47K May 13 08:49 WNCAATourneyCompactResults.csv
 84K -rw-r--r-- 1 nobody  82K May 13 08:49 WNCAATourneyDetailedResults.csv
 28K -rw-r--r-- 1 nobody  25K May 13 08:49 WNCAATourneySeeds.csv
 36K -rw-r--r-- 1 nobody  34K May 13 08:49 WNCAATourneySlots.csv
3.7M -rw-r--r-- 1 nobody 3.7M May 13 08:49 WRegularSeasonCompactResults.csv
7.3M -rw-r--r-- 1 nobody 7.3M May 13 08:49 WRegularSeasonDetailedResults.csv
4.0K -rw-r--r-- 1 nobody 1.4K May 13 08:49 WSeasons.csv
156K -rw-r--r-- 1 nobody 154K May 13 08:49 WTeamConferences.csv
 24K -rw-r--r-- 1 nobody  22K May 13 08:49 WTeamSpellings.csv
8.0K -rw-r--r-- 1 nobody 6.1K May 13 08:49 WTeams.csv
4.0K -rw-r--r-- 1 nobody 2.1K May 13 08:49 sample_submission.csv</code></pre>
</div>
</div>
<ul>
<li><p>*<strong>MRegularSeasonCompactResults.csv &amp; WMRegularSeasonCompactResults.csv</strong></p>
<p>All game results from the regular season.</p></li>
<li><p><strong>MNCAATourneyCompactResults.csv &amp; WNCAATourneyCompactResults.csv</strong></p>
<p>All game results from past tournaments.</p></li>
<li><p><strong>MNCAATourneySeeds.csv &amp; MNCAATourneySeeds.csv</strong></p>
<p>The seeding for the tournaments</p></li>
<li><p>*** 2024_tourney_seeds.csv**</p>
<p>File that will be updated with 2024 seeds once released (2023 seeds prior to that)</p></li>
</ul>
<div id="cell-4" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:48.961929Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:48.961421Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:48.968782Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:48.967196Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:48.961880Z&quot;}" data-papermill="{&quot;duration&quot;:0.016358,&quot;end_time&quot;:&quot;2024-06-05T15:38:41.409851&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-06-05T15:38:41.393493&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-trusted="true" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>DATA_PATH <span class="op">=</span> <span class="st">"../input/march-machine-learning-mania-2024/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:48.972850Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:48.971826Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:49.511151Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:49.510063Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:48.972805Z&quot;}" data-papermill="{&quot;duration&quot;:0.467744,&quot;end_time&quot;:&quot;2024-06-05T15:38:41.881579&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-06-05T15:38:41.413835&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-trusted="true" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_seeds <span class="op">=</span> pd.concat(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"MNCAATourneySeeds.csv"</span>).assign(League<span class="op">=</span><span class="st">"M"</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"WNCAATourneySeeds.csv"</span>).assign(League<span class="op">=</span><span class="st">"W"</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_season_results <span class="op">=</span> pd.concat(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"MRegularSeasonCompactResults.csv"</span>).assign(League<span class="op">=</span><span class="st">"M"</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"WRegularSeasonCompactResults.csv"</span>).assign(League<span class="op">=</span><span class="st">"W"</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>df_tourney_results <span class="op">=</span> pd.concat(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"MNCAATourneyCompactResults.csv"</span>).assign(League<span class="op">=</span><span class="st">"M"</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"WNCAATourneyCompactResults.csv"</span>).assign(League<span class="op">=</span><span class="st">"W"</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:49.512806Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:49.512415Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:49.545196Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:49.543560Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:49.512759Z&quot;}" data-trusted="true" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Season <span class="op">=</span> <span class="dv">2024</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>filtered_wins <span class="op">=</span>  df_seeds[ df_seeds[<span class="st">'Season'</span>] <span class="op">==</span> Season]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>filtered_wins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">Seed</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">League</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2490</td>
<td>2024</td>
<td>W01</td>
<td>1163</td>
<td>M</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2491</td>
<td>2024</td>
<td>W02</td>
<td>1235</td>
<td>M</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2492</td>
<td>2024</td>
<td>W03</td>
<td>1228</td>
<td>M</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2493</td>
<td>2024</td>
<td>W04</td>
<td>1120</td>
<td>M</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2494</td>
<td>2024</td>
<td>W05</td>
<td>1361</td>
<td>M</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4229</td>
<td>2024</td>
<td>Z12b</td>
<td>3435</td>
<td>W</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4230</td>
<td>2024</td>
<td>Z13</td>
<td>3267</td>
<td>W</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4231</td>
<td>2024</td>
<td>Z14</td>
<td>3238</td>
<td>W</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4232</td>
<td>2024</td>
<td>Z15</td>
<td>3263</td>
<td>W</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4233</td>
<td>2024</td>
<td>Z16</td>
<td>3394</td>
<td>W</td>
</tr>
</tbody>
</table>

<p>136 rows × 4 columns</p>
</div>
</div>
</div>
</div>
<section id="creating-team-season-results" class="level1">
<h1><strong>Creating Team Season Results</strong></h1>
<ul>
<li>We the the data from the existing format with 1 row per game</li>
<li>New format has 1 row for each team’s game - win or loss.</li>
<li>This data can be aggregated for season metrics</li>
</ul>
<div id="cell-9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:49.547307Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:49.546898Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:49.781615Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:49.780228Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:49.547271Z&quot;}" data-papermill="{&quot;duration&quot;:0.005604,&quot;end_time&quot;:&quot;2024-06-05T15:38:41.893202&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-06-05T15:38:41.887598&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-trusted="true" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_team_season_results <span class="op">=</span> pd.concat(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        df_season_results[[<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"WTeamID"</span>, <span class="st">"DayNum"</span>, <span class="st">"WScore"</span>, <span class="st">"LScore"</span>]]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        .assign(GameResult<span class="op">=</span><span class="st">"W"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        .rename(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{<span class="st">"WTeamID"</span>: <span class="st">"TeamID"</span>, <span class="st">"WScore"</span>: <span class="st">"TeamScore"</span>, <span class="st">"LScore"</span>: <span class="st">"OppScore"</span>}</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        df_season_results[[<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"LTeamID"</span>, <span class="st">"DayNum"</span>, <span class="st">"WScore"</span>, <span class="st">"LScore"</span>]]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        .assign(GameResult<span class="op">=</span><span class="st">"L"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        .rename(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{<span class="st">"LTeamID"</span>: <span class="st">"TeamID"</span>, <span class="st">"LScore"</span>: <span class="st">"TeamScore"</span>, <span class="st">"WScore"</span>: <span class="st">"OppScore"</span>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-season-features" class="level1">
<h1>Create Season Features</h1>
<ul>
<li>add some features to this data like the score differential</li>
</ul>
<div id="cell-11" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:49.783969Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:49.783621Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:49.841322Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:49.840113Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:49.783934Z&quot;}" data-papermill="{&quot;duration&quot;:0.004238,&quot;end_time&quot;:&quot;2024-06-05T15:38:41.903307&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-06-05T15:38:41.899069&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-trusted="true" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Score Differential</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_team_season_results[<span class="st">"ScoreDiff"</span>] <span class="op">=</span> (</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    df_team_season_results[<span class="st">"TeamScore"</span>] <span class="op">-</span> df_team_season_results[<span class="st">"OppScore"</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>df_team_season_results[<span class="st">"Win"</span>] <span class="op">=</span> (df_team_season_results[<span class="st">"GameResult"</span>] <span class="op">==</span> <span class="st">"W"</span>).astype(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"int"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:49.846567Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:49.846126Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:49.885527Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:49.884529Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:49.846524Z&quot;}" data-trusted="true" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_team_season_results.sample(<span class="dv">10</span>, random_state<span class="op">=</span><span class="dv">529</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">DayNum</th>
<th data-quarto-table-cell-role="th">TeamScore</th>
<th data-quarto-table-cell-role="th">OppScore</th>
<th data-quarto-table-cell-role="th">GameResult</th>
<th data-quarto-table-cell-role="th">ScoreDiff</th>
<th data-quarto-table-cell-role="th">Win</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">493232</td>
<td>2022</td>
<td>M</td>
<td>1444</td>
<td>96</td>
<td>64</td>
<td>77</td>
<td>L</td>
<td>-13</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">71811</td>
<td>2002</td>
<td>M</td>
<td>1281</td>
<td>79</td>
<td>74</td>
<td>50</td>
<td>W</td>
<td>24</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">555548</td>
<td>2008</td>
<td>W</td>
<td>3276</td>
<td>115</td>
<td>67</td>
<td>69</td>
<td>L</td>
<td>-2</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">84226</td>
<td>2005</td>
<td>M</td>
<td>1393</td>
<td>40</td>
<td>86</td>
<td>56</td>
<td>W</td>
<td>30</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">129439</td>
<td>2014</td>
<td>M</td>
<td>1368</td>
<td>8</td>
<td>63</td>
<td>62</td>
<td>W</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">364900</td>
<td>1996</td>
<td>M</td>
<td>1148</td>
<td>85</td>
<td>46</td>
<td>116</td>
<td>L</td>
<td>-70</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">587485</td>
<td>2015</td>
<td>W</td>
<td>3394</td>
<td>18</td>
<td>66</td>
<td>68</td>
<td>L</td>
<td>-2</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">397470</td>
<td>2003</td>
<td>M</td>
<td>1266</td>
<td>129</td>
<td>76</td>
<td>83</td>
<td>L</td>
<td>-7</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99374</td>
<td>2008</td>
<td>M</td>
<td>1177</td>
<td>47</td>
<td>93</td>
<td>88</td>
<td>W</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">532105</td>
<td>2003</td>
<td>W</td>
<td>3414</td>
<td>130</td>
<td>50</td>
<td>83</td>
<td>L</td>
<td>-33</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="aggregate-for-teams-total-season-stats" class="level1">
<h1>Aggregate for team’s total season stats</h1>
<div id="cell-14" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:49.887123Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:49.886822Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:52.883515Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:52.882326Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:49.887097Z&quot;}" data-trusted="true" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>team_season_agg <span class="op">=</span> (</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    df_team_season_results.groupby([<span class="st">"Season"</span>, <span class="st">"TeamID"</span>, <span class="st">"League"</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        AvgScoreDiff<span class="op">=</span>(<span class="st">"ScoreDiff"</span>, <span class="st">"mean"</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        MedianScoreDiff<span class="op">=</span>(<span class="st">"ScoreDiff"</span>, <span class="st">"median"</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        MinScoreDiff<span class="op">=</span>(<span class="st">"ScoreDiff"</span>, <span class="st">"min"</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        MaxScoreDiff<span class="op">=</span>(<span class="st">"ScoreDiff"</span>, <span class="st">"max"</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        Wins<span class="op">=</span>(<span class="st">"Win"</span>, <span class="st">"sum"</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        Losses<span class="op">=</span>(<span class="st">"GameResult"</span>, <span class="kw">lambda</span> x: (x <span class="op">==</span> <span class="st">"L"</span>).<span class="bu">sum</span>()),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        WinPercentage<span class="op">=</span>(<span class="st">"Win"</span>, <span class="st">"mean"</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:52.889150Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:52.888758Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:52.906527Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:52.905037Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:52.889123Z&quot;}" data-trusted="true" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>team_season_agg.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">AvgScoreDiff</th>
<th data-quarto-table-cell-role="th">MedianScoreDiff</th>
<th data-quarto-table-cell-role="th">MinScoreDiff</th>
<th data-quarto-table-cell-role="th">MaxScoreDiff</th>
<th data-quarto-table-cell-role="th">Wins</th>
<th data-quarto-table-cell-role="th">Losses</th>
<th data-quarto-table-cell-role="th">WinPercentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1985</td>
<td>1102</td>
<td>M</td>
<td>-5.791667</td>
<td>-5.5</td>
<td>-41</td>
<td>29</td>
<td>5</td>
<td>19</td>
<td>0.208333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1985</td>
<td>1103</td>
<td>M</td>
<td>-3.043478</td>
<td>-2.0</td>
<td>-22</td>
<td>16</td>
<td>9</td>
<td>14</td>
<td>0.391304</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1985</td>
<td>1104</td>
<td>M</td>
<td>7.800000</td>
<td>6.5</td>
<td>-12</td>
<td>25</td>
<td>21</td>
<td>9</td>
<td>0.700000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1985</td>
<td>1106</td>
<td>M</td>
<td>-3.791667</td>
<td>-1.5</td>
<td>-35</td>
<td>28</td>
<td>10</td>
<td>14</td>
<td>0.416667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1985</td>
<td>1108</td>
<td>M</td>
<td>7.960000</td>
<td>4.0</td>
<td>-15</td>
<td>35</td>
<td>19</td>
<td>6</td>
<td>0.760000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:52.908651Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:52.908174Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:52.941921Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:52.940486Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:52.908541Z&quot;}" data-trusted="true" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_seeds[<span class="st">"ChalkSeed"</span>] <span class="op">=</span> (</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    df_seeds[<span class="st">"Seed"</span>].<span class="bu">str</span>.replace(<span class="st">"a"</span>, <span class="st">""</span>).<span class="bu">str</span>.replace(<span class="st">"b"</span>, <span class="st">""</span>).<span class="bu">str</span>[<span class="dv">1</span>:].astype(<span class="st">"int"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>team_season_agg <span class="op">=</span> team_season_agg.merge(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    df_seeds, on<span class="op">=</span>[<span class="st">"Season"</span>, <span class="st">"TeamID"</span>, <span class="st">"League"</span>], how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:52.943692Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:52.943322Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:52.951295Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:52.949957Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:52.943662Z&quot;}" data-trusted="true" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>team_season_agg.shape, df_seeds.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>((22150, 12), (4234, 5))</code></pre>
</div>
</div>
</section>
<section id="tournament-results-aggregation" class="level1">
<h1>Tournament Results Aggregation</h1>
<div id="cell-19" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:52.953489Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:52.953044Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:52.975360Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:52.973852Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:52.953426Z&quot;}" data-trusted="true" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_team_tourney_results <span class="op">=</span> pd.concat(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        df_tourney_results[</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"WTeamID"</span>, <span class="st">"LTeamID"</span>, <span class="st">"WScore"</span>, <span class="st">"LScore"</span>]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        .assign(GameResult<span class="op">=</span><span class="st">"W"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        .rename(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WTeamID"</span>: <span class="st">"TeamID"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"LTeamID"</span>: <span class="st">"OppTeamID"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WScore"</span>: <span class="st">"TeamScore"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"LScore"</span>: <span class="st">"OppScore"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        df_tourney_results[</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"LTeamID"</span>, <span class="st">"WTeamID"</span>, <span class="st">"LScore"</span>, <span class="st">"WScore"</span>]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        .assign(GameResult<span class="op">=</span><span class="st">"L"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        .rename(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"LTeamID"</span>: <span class="st">"TeamID"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WTeamID"</span>: <span class="st">"OppTeamID"</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">"LScore"</span>: <span class="st">"TeamScore"</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WScore"</span>: <span class="st">"OppScore"</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>df_team_tourney_results[<span class="st">"Win"</span>] <span class="op">=</span> (df_team_tourney_results[<span class="st">"GameResult"</span>] <span class="op">==</span> <span class="st">"W"</span>).astype(</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"int"</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-20" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:52.978231Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:52.977249Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:52.993994Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:52.992692Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:52.978188Z&quot;}" data-trusted="true" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_team_tourney_results.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">OppTeamID</th>
<th data-quarto-table-cell-role="th">TeamScore</th>
<th data-quarto-table-cell-role="th">OppScore</th>
<th data-quarto-table-cell-role="th">GameResult</th>
<th data-quarto-table-cell-role="th">Win</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1985</td>
<td>M</td>
<td>1116</td>
<td>1234</td>
<td>63</td>
<td>54</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1985</td>
<td>M</td>
<td>1120</td>
<td>1345</td>
<td>59</td>
<td>58</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1985</td>
<td>M</td>
<td>1207</td>
<td>1250</td>
<td>68</td>
<td>43</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1985</td>
<td>M</td>
<td>1229</td>
<td>1425</td>
<td>58</td>
<td>55</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1985</td>
<td>M</td>
<td>1242</td>
<td>1325</td>
<td>49</td>
<td>38</td>
<td>W</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="tourney-dataset-with-features" class="level1">
<h1>Tourney Dataset with Features</h1>
<ul>
<li>merge our team’s regular season features with our tourney dataframe.</li>
<li>This gives us the data format that we will use to train our model.</li>
<li>target column is the “Winner” and the features are the regular season stats.</li>
</ul>
<div id="cell-22" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:52.996029Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:52.995621Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:53.037773Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:53.036537Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:52.995994Z&quot;}" data-trusted="true" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features <span class="op">=</span> df_team_tourney_results.merge(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    team_season_agg[</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamID"</span>, <span class="st">"WinPercentage"</span>, <span class="st">"MedianScoreDiff"</span>, <span class="st">"ChalkSeed"</span>]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamID"</span>],</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>).merge(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    team_season_agg[</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamID"</span>, <span class="st">"WinPercentage"</span>, <span class="st">"MedianScoreDiff"</span>, <span class="st">"ChalkSeed"</span>]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    ].rename(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>{</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"TeamID"</span>: <span class="st">"OppTeamID"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"WinPercentage"</span>: <span class="st">"OppWinPercentage"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MedianScoreDiff"</span>: <span class="st">"OppMedianScoreDiff"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ChalkSeed"</span>: <span class="st">"OppChalkSeed"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"OppTeamID"</span>],</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:53.040363Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:53.039860Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:53.062746Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:53.061341Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:53.040323Z&quot;}" data-trusted="true" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">OppTeamID</th>
<th data-quarto-table-cell-role="th">TeamScore</th>
<th data-quarto-table-cell-role="th">OppScore</th>
<th data-quarto-table-cell-role="th">GameResult</th>
<th data-quarto-table-cell-role="th">Win</th>
<th data-quarto-table-cell-role="th">WinPercentage</th>
<th data-quarto-table-cell-role="th">MedianScoreDiff</th>
<th data-quarto-table-cell-role="th">ChalkSeed</th>
<th data-quarto-table-cell-role="th">OppWinPercentage</th>
<th data-quarto-table-cell-role="th">OppMedianScoreDiff</th>
<th data-quarto-table-cell-role="th">OppChalkSeed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1985</td>
<td>M</td>
<td>1116</td>
<td>1234</td>
<td>63</td>
<td>54</td>
<td>W</td>
<td>1</td>
<td>0.636364</td>
<td>5.0</td>
<td>9.0</td>
<td>0.666667</td>
<td>9.5</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1985</td>
<td>M</td>
<td>1120</td>
<td>1345</td>
<td>59</td>
<td>58</td>
<td>W</td>
<td>1</td>
<td>0.620690</td>
<td>2.0</td>
<td>11.0</td>
<td>0.680000</td>
<td>9.0</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1985</td>
<td>M</td>
<td>1207</td>
<td>1250</td>
<td>68</td>
<td>43</td>
<td>W</td>
<td>1</td>
<td>0.925926</td>
<td>14.0</td>
<td>1.0</td>
<td>0.379310</td>
<td>-3.0</td>
<td>16.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1985</td>
<td>M</td>
<td>1229</td>
<td>1425</td>
<td>58</td>
<td>55</td>
<td>W</td>
<td>1</td>
<td>0.740741</td>
<td>6.0</td>
<td>9.0</td>
<td>0.678571</td>
<td>2.5</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1985</td>
<td>M</td>
<td>1242</td>
<td>1325</td>
<td>49</td>
<td>38</td>
<td>W</td>
<td>1</td>
<td>0.766667</td>
<td>5.5</td>
<td>3.0</td>
<td>0.740741</td>
<td>6.0</td>
<td>14.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:53.065219Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:53.064729Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:53.077125Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:53.075783Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:53.065174Z&quot;}" data-trusted="true" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a> df_historic_tourney_features.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>Index(['Season', 'League', 'TeamID', 'OppTeamID', 'TeamScore', 'OppScore',
       'GameResult', 'Win', 'WinPercentage', 'MedianScoreDiff', 'ChalkSeed',
       'OppWinPercentage', 'OppMedianScoreDiff', 'OppChalkSeed'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:53.079507Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:53.079040Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:53.093856Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:53.092397Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:53.079447Z&quot;}" data-trusted="true" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features[<span class="st">"WinPctDiff"</span>] <span class="op">=</span> (</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    df_historic_tourney_features[<span class="st">"WinPercentage"</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> df_historic_tourney_features[<span class="st">"OppWinPercentage"</span>]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features[<span class="st">"ChalkSeedDiff"</span>] <span class="op">=</span> (</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    df_historic_tourney_features[<span class="st">"ChalkSeed"</span>]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> df_historic_tourney_features[<span class="st">"OppChalkSeed"</span>]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features[<span class="st">"MedianScoreDiffDiff"</span>] <span class="op">=</span> (</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    df_historic_tourney_features[<span class="st">"MedianScoreDiff"</span>]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> df_historic_tourney_features[<span class="st">"OppMedianScoreDiff"</span>]</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-26" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:53.096190Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:53.095660Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:53.124782Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:53.123165Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:53.096145Z&quot;}" data-trusted="true" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">OppTeamID</th>
<th data-quarto-table-cell-role="th">TeamScore</th>
<th data-quarto-table-cell-role="th">OppScore</th>
<th data-quarto-table-cell-role="th">GameResult</th>
<th data-quarto-table-cell-role="th">Win</th>
<th data-quarto-table-cell-role="th">WinPercentage</th>
<th data-quarto-table-cell-role="th">MedianScoreDiff</th>
<th data-quarto-table-cell-role="th">ChalkSeed</th>
<th data-quarto-table-cell-role="th">OppWinPercentage</th>
<th data-quarto-table-cell-role="th">OppMedianScoreDiff</th>
<th data-quarto-table-cell-role="th">OppChalkSeed</th>
<th data-quarto-table-cell-role="th">WinPctDiff</th>
<th data-quarto-table-cell-role="th">ChalkSeedDiff</th>
<th data-quarto-table-cell-role="th">MedianScoreDiffDiff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1985</td>
<td>M</td>
<td>1116</td>
<td>1234</td>
<td>63</td>
<td>54</td>
<td>W</td>
<td>1</td>
<td>0.636364</td>
<td>5.0</td>
<td>9.0</td>
<td>0.666667</td>
<td>9.5</td>
<td>8.0</td>
<td>-0.030303</td>
<td>1.0</td>
<td>-4.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1985</td>
<td>M</td>
<td>1120</td>
<td>1345</td>
<td>59</td>
<td>58</td>
<td>W</td>
<td>1</td>
<td>0.620690</td>
<td>2.0</td>
<td>11.0</td>
<td>0.680000</td>
<td>9.0</td>
<td>6.0</td>
<td>-0.059310</td>
<td>5.0</td>
<td>-7.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1985</td>
<td>M</td>
<td>1207</td>
<td>1250</td>
<td>68</td>
<td>43</td>
<td>W</td>
<td>1</td>
<td>0.925926</td>
<td>14.0</td>
<td>1.0</td>
<td>0.379310</td>
<td>-3.0</td>
<td>16.0</td>
<td>0.546616</td>
<td>-15.0</td>
<td>17.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1985</td>
<td>M</td>
<td>1229</td>
<td>1425</td>
<td>58</td>
<td>55</td>
<td>W</td>
<td>1</td>
<td>0.740741</td>
<td>6.0</td>
<td>9.0</td>
<td>0.678571</td>
<td>2.5</td>
<td>8.0</td>
<td>0.062169</td>
<td>1.0</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1985</td>
<td>M</td>
<td>1242</td>
<td>1325</td>
<td>49</td>
<td>38</td>
<td>W</td>
<td>1</td>
<td>0.766667</td>
<td>5.5</td>
<td>3.0</td>
<td>0.740741</td>
<td>6.0</td>
<td>14.0</td>
<td>0.025926</td>
<td>-11.0</td>
<td>-0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8063</td>
<td>2023</td>
<td>W</td>
<td>3268</td>
<td>3376</td>
<td>75</td>
<td>86</td>
<td>L</td>
<td>0</td>
<td>0.806452</td>
<td>11.0</td>
<td>2.0</td>
<td>1.000000</td>
<td>28.0</td>
<td>1.0</td>
<td>-0.193548</td>
<td>1.0</td>
<td>-17.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8064</td>
<td>2023</td>
<td>W</td>
<td>3326</td>
<td>3439</td>
<td>74</td>
<td>84</td>
<td>L</td>
<td>0</td>
<td>0.781250</td>
<td>12.0</td>
<td>3.0</td>
<td>0.870968</td>
<td>13.0</td>
<td>1.0</td>
<td>-0.089718</td>
<td>2.0</td>
<td>-1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8065</td>
<td>2023</td>
<td>W</td>
<td>3376</td>
<td>3234</td>
<td>73</td>
<td>77</td>
<td>L</td>
<td>0</td>
<td>1.000000</td>
<td>28.0</td>
<td>1.0</td>
<td>0.812500</td>
<td>13.5</td>
<td>2.0</td>
<td>0.187500</td>
<td>-1.0</td>
<td>14.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8066</td>
<td>2023</td>
<td>W</td>
<td>3439</td>
<td>3261</td>
<td>72</td>
<td>79</td>
<td>L</td>
<td>0</td>
<td>0.870968</td>
<td>13.0</td>
<td>1.0</td>
<td>0.933333</td>
<td>22.0</td>
<td>3.0</td>
<td>-0.062366</td>
<td>-2.0</td>
<td>-9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8067</td>
<td>2023</td>
<td>W</td>
<td>3234</td>
<td>3261</td>
<td>85</td>
<td>102</td>
<td>L</td>
<td>0</td>
<td>0.812500</td>
<td>13.5</td>
<td>2.0</td>
<td>0.933333</td>
<td>22.0</td>
<td>3.0</td>
<td>-0.120833</td>
<td>-1.0</td>
<td>-8.5</td>
</tr>
</tbody>
</table>

<p>8068 rows × 17 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:53.127068Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:53.126698Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:53.184080Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:53.182586Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:53.127037Z&quot;}" data-trusted="true" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>TeamID <span class="op">=</span> <span class="dv">1116</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>filtered_wins <span class="op">=</span>  df_historic_tourney_features[ df_historic_tourney_features[<span class="st">'TeamID'</span>] <span class="op">==</span> TeamID]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>filtered_wins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">OppTeamID</th>
<th data-quarto-table-cell-role="th">TeamScore</th>
<th data-quarto-table-cell-role="th">OppScore</th>
<th data-quarto-table-cell-role="th">GameResult</th>
<th data-quarto-table-cell-role="th">Win</th>
<th data-quarto-table-cell-role="th">WinPercentage</th>
<th data-quarto-table-cell-role="th">MedianScoreDiff</th>
<th data-quarto-table-cell-role="th">ChalkSeed</th>
<th data-quarto-table-cell-role="th">OppWinPercentage</th>
<th data-quarto-table-cell-role="th">OppMedianScoreDiff</th>
<th data-quarto-table-cell-role="th">OppChalkSeed</th>
<th data-quarto-table-cell-role="th">WinPctDiff</th>
<th data-quarto-table-cell-role="th">ChalkSeedDiff</th>
<th data-quarto-table-cell-role="th">MedianScoreDiffDiff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1985</td>
<td>M</td>
<td>1116</td>
<td>1234</td>
<td>63</td>
<td>54</td>
<td>W</td>
<td>1</td>
<td>0.636364</td>
<td>5.0</td>
<td>9.0</td>
<td>0.666667</td>
<td>9.5</td>
<td>8.0</td>
<td>-0.030303</td>
<td>1.0</td>
<td>-4.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">253</td>
<td>1989</td>
<td>M</td>
<td>1116</td>
<td>1258</td>
<td>120</td>
<td>101</td>
<td>W</td>
<td>1</td>
<td>0.800000</td>
<td>16.5</td>
<td>5.0</td>
<td>0.655172</td>
<td>5.0</td>
<td>12.0</td>
<td>0.144828</td>
<td>-7.0</td>
<td>11.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">315</td>
<td>1990</td>
<td>M</td>
<td>1116</td>
<td>1343</td>
<td>68</td>
<td>64</td>
<td>W</td>
<td>1</td>
<td>0.866667</td>
<td>15.0</td>
<td>4.0</td>
<td>0.750000</td>
<td>11.5</td>
<td>13.0</td>
<td>0.116667</td>
<td>-9.0</td>
<td>3.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">347</td>
<td>1990</td>
<td>M</td>
<td>1116</td>
<td>1173</td>
<td>86</td>
<td>84</td>
<td>W</td>
<td>1</td>
<td>0.866667</td>
<td>15.0</td>
<td>4.0</td>
<td>0.700000</td>
<td>6.0</td>
<td>12.0</td>
<td>0.166667</td>
<td>-8.0</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">363</td>
<td>1990</td>
<td>M</td>
<td>1116</td>
<td>1314</td>
<td>96</td>
<td>73</td>
<td>W</td>
<td>1</td>
<td>0.866667</td>
<td>15.0</td>
<td>4.0</td>
<td>0.612903</td>
<td>5.0</td>
<td>8.0</td>
<td>0.253763</td>
<td>-4.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>1990</td>
<td>M</td>
<td>1116</td>
<td>1400</td>
<td>88</td>
<td>85</td>
<td>W</td>
<td>1</td>
<td>0.866667</td>
<td>15.0</td>
<td>4.0</td>
<td>0.700000</td>
<td>6.0</td>
<td>10.0</td>
<td>0.166667</td>
<td>-6.0</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396</td>
<td>1991</td>
<td>M</td>
<td>1116</td>
<td>1209</td>
<td>117</td>
<td>76</td>
<td>W</td>
<td>1</td>
<td>0.909091</td>
<td>20.0</td>
<td>1.0</td>
<td>0.533333</td>
<td>1.0</td>
<td>16.0</td>
<td>0.375758</td>
<td>-15.0</td>
<td>19.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">419</td>
<td>1991</td>
<td>M</td>
<td>1116</td>
<td>1113</td>
<td>97</td>
<td>90</td>
<td>W</td>
<td>1</td>
<td>0.909091</td>
<td>20.0</td>
<td>1.0</td>
<td>0.678571</td>
<td>6.0</td>
<td>8.0</td>
<td>0.230519</td>
<td>-7.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">426</td>
<td>1991</td>
<td>M</td>
<td>1116</td>
<td>1104</td>
<td>93</td>
<td>70</td>
<td>W</td>
<td>1</td>
<td>0.909091</td>
<td>20.0</td>
<td>1.0</td>
<td>0.700000</td>
<td>5.5</td>
<td>4.0</td>
<td>0.209091</td>
<td>-3.0</td>
<td>14.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">442</td>
<td>1992</td>
<td>M</td>
<td>1116</td>
<td>1293</td>
<td>80</td>
<td>69</td>
<td>W</td>
<td>1</td>
<td>0.758621</td>
<td>11.0</td>
<td>3.0</td>
<td>0.571429</td>
<td>3.0</td>
<td>14.0</td>
<td>0.187192</td>
<td>-11.0</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">504</td>
<td>1993</td>
<td>M</td>
<td>1116</td>
<td>1221</td>
<td>94</td>
<td>64</td>
<td>W</td>
<td>1</td>
<td>0.714286</td>
<td>8.0</td>
<td>4.0</td>
<td>0.793103</td>
<td>10.0</td>
<td>13.0</td>
<td>-0.078818</td>
<td>-9.0</td>
<td>-2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">536</td>
<td>1993</td>
<td>M</td>
<td>1116</td>
<td>1385</td>
<td>80</td>
<td>74</td>
<td>W</td>
<td>1</td>
<td>0.714286</td>
<td>8.0</td>
<td>4.0</td>
<td>0.642857</td>
<td>4.0</td>
<td>5.0</td>
<td>0.071429</td>
<td>-1.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">584</td>
<td>1994</td>
<td>M</td>
<td>1116</td>
<td>1299</td>
<td>94</td>
<td>79</td>
<td>W</td>
<td>1</td>
<td>0.888889</td>
<td>13.0</td>
<td>1.0</td>
<td>0.555556</td>
<td>3.0</td>
<td>16.0</td>
<td>0.333333</td>
<td>-15.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">608</td>
<td>1994</td>
<td>M</td>
<td>1116</td>
<td>1207</td>
<td>85</td>
<td>73</td>
<td>W</td>
<td>1</td>
<td>0.888889</td>
<td>13.0</td>
<td>1.0</td>
<td>0.592593</td>
<td>4.0</td>
<td>9.0</td>
<td>0.296296</td>
<td>-8.0</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">619</td>
<td>1994</td>
<td>M</td>
<td>1116</td>
<td>1409</td>
<td>103</td>
<td>84</td>
<td>W</td>
<td>1</td>
<td>0.888889</td>
<td>13.0</td>
<td>1.0</td>
<td>0.740741</td>
<td>10.0</td>
<td>12.0</td>
<td>0.148148</td>
<td>-11.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">625</td>
<td>1994</td>
<td>M</td>
<td>1116</td>
<td>1276</td>
<td>76</td>
<td>68</td>
<td>W</td>
<td>1</td>
<td>0.888889</td>
<td>13.0</td>
<td>1.0</td>
<td>0.750000</td>
<td>7.5</td>
<td>3.0</td>
<td>0.138889</td>
<td>-2.0</td>
<td>5.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">627</td>
<td>1994</td>
<td>M</td>
<td>1116</td>
<td>1112</td>
<td>91</td>
<td>82</td>
<td>W</td>
<td>1</td>
<td>0.888889</td>
<td>13.0</td>
<td>1.0</td>
<td>0.833333</td>
<td>17.0</td>
<td>2.0</td>
<td>0.055556</td>
<td>-1.0</td>
<td>-4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">629</td>
<td>1994</td>
<td>M</td>
<td>1116</td>
<td>1181</td>
<td>76</td>
<td>72</td>
<td>W</td>
<td>1</td>
<td>0.888889</td>
<td>13.0</td>
<td>1.0</td>
<td>0.821429</td>
<td>12.0</td>
<td>2.0</td>
<td>0.067460</td>
<td>-1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">646</td>
<td>1995</td>
<td>M</td>
<td>1116</td>
<td>1411</td>
<td>79</td>
<td>78</td>
<td>W</td>
<td>1</td>
<td>0.812500</td>
<td>7.5</td>
<td>2.0</td>
<td>0.769231</td>
<td>6.0</td>
<td>15.0</td>
<td>0.043269</td>
<td>-13.0</td>
<td>1.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">670</td>
<td>1995</td>
<td>M</td>
<td>1116</td>
<td>1393</td>
<td>96</td>
<td>94</td>
<td>W</td>
<td>1</td>
<td>0.812500</td>
<td>7.5</td>
<td>2.0</td>
<td>0.666667</td>
<td>2.0</td>
<td>7.0</td>
<td>0.145833</td>
<td>-5.0</td>
<td>5.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">682</td>
<td>1995</td>
<td>M</td>
<td>1116</td>
<td>1272</td>
<td>96</td>
<td>91</td>
<td>W</td>
<td>1</td>
<td>0.812500</td>
<td>7.5</td>
<td>2.0</td>
<td>0.709677</td>
<td>6.0</td>
<td>6.0</td>
<td>0.102823</td>
<td>-4.0</td>
<td>1.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">688</td>
<td>1995</td>
<td>M</td>
<td>1116</td>
<td>1438</td>
<td>68</td>
<td>61</td>
<td>W</td>
<td>1</td>
<td>0.812500</td>
<td>7.5</td>
<td>2.0</td>
<td>0.733333</td>
<td>8.0</td>
<td>4.0</td>
<td>0.079167</td>
<td>-2.0</td>
<td>-0.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">690</td>
<td>1995</td>
<td>M</td>
<td>1116</td>
<td>1314</td>
<td>75</td>
<td>68</td>
<td>W</td>
<td>1</td>
<td>0.812500</td>
<td>7.5</td>
<td>2.0</td>
<td>0.827586</td>
<td>10.0</td>
<td>2.0</td>
<td>-0.015086</td>
<td>0.0</td>
<td>-2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">693</td>
<td>1996</td>
<td>M</td>
<td>1116</td>
<td>1336</td>
<td>86</td>
<td>80</td>
<td>W</td>
<td>1</td>
<td>0.600000</td>
<td>7.0</td>
<td>12.0</td>
<td>0.777778</td>
<td>10.0</td>
<td>5.0</td>
<td>-0.177778</td>
<td>7.0</td>
<td>-3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">725</td>
<td>1996</td>
<td>M</td>
<td>1116</td>
<td>1266</td>
<td>65</td>
<td>56</td>
<td>W</td>
<td>1</td>
<td>0.600000</td>
<td>7.0</td>
<td>12.0</td>
<td>0.758621</td>
<td>9.0</td>
<td>4.0</td>
<td>-0.158621</td>
<td>8.0</td>
<td>-2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">820</td>
<td>1998</td>
<td>M</td>
<td>1116</td>
<td>1304</td>
<td>74</td>
<td>65</td>
<td>W</td>
<td>1</td>
<td>0.766667</td>
<td>7.5</td>
<td>6.0</td>
<td>0.645161</td>
<td>8.0</td>
<td>11.0</td>
<td>0.121505</td>
<td>-5.0</td>
<td>-0.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">882</td>
<td>1999</td>
<td>M</td>
<td>1116</td>
<td>1373</td>
<td>94</td>
<td>80</td>
<td>W</td>
<td>1</td>
<td>0.687500</td>
<td>5.0</td>
<td>4.0</td>
<td>0.833333</td>
<td>8.0</td>
<td>13.0</td>
<td>-0.145833</td>
<td>-9.0</td>
<td>-3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1473</td>
<td>2008</td>
<td>M</td>
<td>1116</td>
<td>1231</td>
<td>86</td>
<td>72</td>
<td>W</td>
<td>1</td>
<td>0.666667</td>
<td>6.0</td>
<td>9.0</td>
<td>0.781250</td>
<td>10.5</td>
<td>8.0</td>
<td>-0.114583</td>
<td>1.0</td>
<td>-4.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1921</td>
<td>2015</td>
<td>M</td>
<td>1116</td>
<td>1459</td>
<td>56</td>
<td>53</td>
<td>W</td>
<td>1</td>
<td>0.764706</td>
<td>7.0</td>
<td>5.0</td>
<td>0.812500</td>
<td>5.5</td>
<td>12.0</td>
<td>-0.047794</td>
<td>-7.0</td>
<td>1.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2070</td>
<td>2017</td>
<td>M</td>
<td>1116</td>
<td>1371</td>
<td>77</td>
<td>71</td>
<td>W</td>
<td>1</td>
<td>0.735294</td>
<td>8.5</td>
<td>8.0</td>
<td>0.656250</td>
<td>3.0</td>
<td>9.0</td>
<td>0.079044</td>
<td>-1.0</td>
<td>5.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2255</td>
<td>2021</td>
<td>M</td>
<td>1116</td>
<td>1159</td>
<td>85</td>
<td>68</td>
<td>W</td>
<td>1</td>
<td>0.785714</td>
<td>11.5</td>
<td>3.0</td>
<td>0.933333</td>
<td>11.0</td>
<td>14.0</td>
<td>-0.147619</td>
<td>-11.0</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2286</td>
<td>2021</td>
<td>M</td>
<td>1116</td>
<td>1403</td>
<td>68</td>
<td>66</td>
<td>W</td>
<td>1</td>
<td>0.785714</td>
<td>11.5</td>
<td>3.0</td>
<td>0.629630</td>
<td>5.0</td>
<td>6.0</td>
<td>0.156085</td>
<td>-3.0</td>
<td>6.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2302</td>
<td>2021</td>
<td>M</td>
<td>1116</td>
<td>1331</td>
<td>72</td>
<td>70</td>
<td>W</td>
<td>1</td>
<td>0.785714</td>
<td>11.5</td>
<td>3.0</td>
<td>0.565217</td>
<td>2.0</td>
<td>15.0</td>
<td>0.220497</td>
<td>-12.0</td>
<td>9.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2321</td>
<td>2022</td>
<td>M</td>
<td>1116</td>
<td>1436</td>
<td>75</td>
<td>71</td>
<td>W</td>
<td>1</td>
<td>0.757576</td>
<td>8.0</td>
<td>4.0</td>
<td>0.843750</td>
<td>13.0</td>
<td>13.0</td>
<td>-0.086174</td>
<td>-9.0</td>
<td>-5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2353</td>
<td>2022</td>
<td>M</td>
<td>1116</td>
<td>1308</td>
<td>53</td>
<td>48</td>
<td>W</td>
<td>1</td>
<td>0.757576</td>
<td>8.0</td>
<td>4.0</td>
<td>0.793103</td>
<td>11.0</td>
<td>12.0</td>
<td>-0.035528</td>
<td>-8.0</td>
<td>-3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2369</td>
<td>2022</td>
<td>M</td>
<td>1116</td>
<td>1211</td>
<td>74</td>
<td>68</td>
<td>W</td>
<td>1</td>
<td>0.757576</td>
<td>8.0</td>
<td>4.0</td>
<td>0.896552</td>
<td>25.0</td>
<td>1.0</td>
<td>-0.138976</td>
<td>3.0</td>
<td>-17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2389</td>
<td>2023</td>
<td>M</td>
<td>1116</td>
<td>1228</td>
<td>73</td>
<td>63</td>
<td>W</td>
<td>1</td>
<td>0.606061</td>
<td>6.0</td>
<td>8.0</td>
<td>0.625000</td>
<td>9.0</td>
<td>9.0</td>
<td>-0.018939</td>
<td>-1.0</td>
<td>-3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2421</td>
<td>2023</td>
<td>M</td>
<td>1116</td>
<td>1242</td>
<td>72</td>
<td>71</td>
<td>W</td>
<td>1</td>
<td>0.606061</td>
<td>6.0</td>
<td>8.0</td>
<td>0.794118</td>
<td>6.0</td>
<td>1.0</td>
<td>-0.188057</td>
<td>7.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4073</td>
<td>1985</td>
<td>M</td>
<td>1116</td>
<td>1385</td>
<td>65</td>
<td>68</td>
<td>L</td>
<td>0</td>
<td>0.636364</td>
<td>5.0</td>
<td>9.0</td>
<td>0.900000</td>
<td>11.0</td>
<td>1.0</td>
<td>-0.263636</td>
<td>8.0</td>
<td>-6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4254</td>
<td>1988</td>
<td>M</td>
<td>1116</td>
<td>1437</td>
<td>74</td>
<td>82</td>
<td>L</td>
<td>0</td>
<td>0.724138</td>
<td>10.0</td>
<td>11.0</td>
<td>0.636364</td>
<td>3.0</td>
<td>6.0</td>
<td>0.087774</td>
<td>5.0</td>
<td>7.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4321</td>
<td>1989</td>
<td>M</td>
<td>1116</td>
<td>1257</td>
<td>84</td>
<td>93</td>
<td>L</td>
<td>0</td>
<td>0.800000</td>
<td>16.5</td>
<td>5.0</td>
<td>0.733333</td>
<td>8.0</td>
<td>4.0</td>
<td>0.066667</td>
<td>1.0</td>
<td>8.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4409</td>
<td>1990</td>
<td>M</td>
<td>1116</td>
<td>1181</td>
<td>83</td>
<td>97</td>
<td>L</td>
<td>0</td>
<td>0.866667</td>
<td>15.0</td>
<td>4.0</td>
<td>0.750000</td>
<td>11.5</td>
<td>3.0</td>
<td>0.116667</td>
<td>1.0</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4468</td>
<td>1991</td>
<td>M</td>
<td>1116</td>
<td>1242</td>
<td>81</td>
<td>93</td>
<td>L</td>
<td>0</td>
<td>0.909091</td>
<td>20.0</td>
<td>1.0</td>
<td>0.750000</td>
<td>10.5</td>
<td>3.0</td>
<td>0.159091</td>
<td>-2.0</td>
<td>9.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4511</td>
<td>1992</td>
<td>M</td>
<td>1116</td>
<td>1272</td>
<td>80</td>
<td>82</td>
<td>L</td>
<td>0</td>
<td>0.758621</td>
<td>11.0</td>
<td>3.0</td>
<td>0.666667</td>
<td>3.5</td>
<td>6.0</td>
<td>0.091954</td>
<td>-3.0</td>
<td>7.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4592</td>
<td>1993</td>
<td>M</td>
<td>1116</td>
<td>1314</td>
<td>74</td>
<td>80</td>
<td>L</td>
<td>0</td>
<td>0.714286</td>
<td>8.0</td>
<td>4.0</td>
<td>0.875000</td>
<td>17.5</td>
<td>1.0</td>
<td>-0.160714</td>
<td>3.0</td>
<td>-9.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4726</td>
<td>1995</td>
<td>M</td>
<td>1116</td>
<td>1417</td>
<td>78</td>
<td>89</td>
<td>L</td>
<td>0</td>
<td>0.812500</td>
<td>7.5</td>
<td>2.0</td>
<td>0.925926</td>
<td>13.0</td>
<td>1.0</td>
<td>-0.113426</td>
<td>1.0</td>
<td>-5.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4777</td>
<td>1996</td>
<td>M</td>
<td>1116</td>
<td>1269</td>
<td>63</td>
<td>79</td>
<td>L</td>
<td>0</td>
<td>0.600000</td>
<td>7.0</td>
<td>12.0</td>
<td>0.968750</td>
<td>12.0</td>
<td>1.0</td>
<td>-0.368750</td>
<td>11.0</td>
<td>-5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4890</td>
<td>1998</td>
<td>M</td>
<td>1116</td>
<td>1428</td>
<td>69</td>
<td>75</td>
<td>L</td>
<td>0</td>
<td>0.766667</td>
<td>7.5</td>
<td>6.0</td>
<td>0.888889</td>
<td>12.0</td>
<td>3.0</td>
<td>-0.122222</td>
<td>3.0</td>
<td>-4.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4952</td>
<td>1999</td>
<td>M</td>
<td>1116</td>
<td>1234</td>
<td>72</td>
<td>82</td>
<td>L</td>
<td>0</td>
<td>0.687500</td>
<td>5.0</td>
<td>4.0</td>
<td>0.666667</td>
<td>4.0</td>
<td>5.0</td>
<td>0.020833</td>
<td>-1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5001</td>
<td>2000</td>
<td>M</td>
<td>1116</td>
<td>1274</td>
<td>71</td>
<td>75</td>
<td>L</td>
<td>0</td>
<td>0.575758</td>
<td>7.0</td>
<td>11.0</td>
<td>0.677419</td>
<td>4.0</td>
<td>6.0</td>
<td>-0.101662</td>
<td>5.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5046</td>
<td>2001</td>
<td>M</td>
<td>1116</td>
<td>1207</td>
<td>61</td>
<td>63</td>
<td>L</td>
<td>0</td>
<td>0.666667</td>
<td>5.5</td>
<td>7.0</td>
<td>0.766667</td>
<td>12.0</td>
<td>10.0</td>
<td>-0.100000</td>
<td>-3.0</td>
<td>-6.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5381</td>
<td>2006</td>
<td>M</td>
<td>1116</td>
<td>1137</td>
<td>55</td>
<td>59</td>
<td>L</td>
<td>0</td>
<td>0.709677</td>
<td>6.0</td>
<td>8.0</td>
<td>0.862069</td>
<td>12.0</td>
<td>9.0</td>
<td>-0.152392</td>
<td>-1.0</td>
<td>-6.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5454</td>
<td>2007</td>
<td>M</td>
<td>1116</td>
<td>1425</td>
<td>60</td>
<td>77</td>
<td>L</td>
<td>0</td>
<td>0.617647</td>
<td>8.0</td>
<td>12.0</td>
<td>0.676471</td>
<td>4.5</td>
<td>5.0</td>
<td>-0.058824</td>
<td>7.0</td>
<td>3.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5534</td>
<td>2008</td>
<td>M</td>
<td>1116</td>
<td>1314</td>
<td>77</td>
<td>108</td>
<td>L</td>
<td>0</td>
<td>0.666667</td>
<td>6.0</td>
<td>9.0</td>
<td>0.941176</td>
<td>12.0</td>
<td>1.0</td>
<td>-0.274510</td>
<td>8.0</td>
<td>-6.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5989</td>
<td>2015</td>
<td>M</td>
<td>1116</td>
<td>1314</td>
<td>78</td>
<td>87</td>
<td>L</td>
<td>0</td>
<td>0.764706</td>
<td>7.0</td>
<td>5.0</td>
<td>0.685714</td>
<td>10.0</td>
<td>4.0</td>
<td>0.078992</td>
<td>1.0</td>
<td>-3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6132</td>
<td>2017</td>
<td>M</td>
<td>1116</td>
<td>1314</td>
<td>65</td>
<td>72</td>
<td>L</td>
<td>0</td>
<td>0.735294</td>
<td>8.5</td>
<td>8.0</td>
<td>0.787879</td>
<td>13.0</td>
<td>1.0</td>
<td>-0.052585</td>
<td>7.0</td>
<td>-4.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6172</td>
<td>2018</td>
<td>M</td>
<td>1116</td>
<td>1139</td>
<td>62</td>
<td>79</td>
<td>L</td>
<td>0</td>
<td>0.676471</td>
<td>4.5</td>
<td>7.0</td>
<td>0.606061</td>
<td>2.0</td>
<td>10.0</td>
<td>0.070410</td>
<td>-3.0</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6344</td>
<td>2021</td>
<td>M</td>
<td>1116</td>
<td>1124</td>
<td>72</td>
<td>81</td>
<td>L</td>
<td>0</td>
<td>0.785714</td>
<td>11.5</td>
<td>3.0</td>
<td>0.916667</td>
<td>14.5</td>
<td>1.0</td>
<td>-0.130952</td>
<td>2.0</td>
<td>-3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6411</td>
<td>2022</td>
<td>M</td>
<td>1116</td>
<td>1181</td>
<td>69</td>
<td>78</td>
<td>L</td>
<td>0</td>
<td>0.757576</td>
<td>8.0</td>
<td>4.0</td>
<td>0.823529</td>
<td>11.5</td>
<td>2.0</td>
<td>-0.065954</td>
<td>2.0</td>
<td>-3.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6470</td>
<td>2023</td>
<td>M</td>
<td>1116</td>
<td>1163</td>
<td>65</td>
<td>88</td>
<td>L</td>
<td>0</td>
<td>0.606061</td>
<td>6.0</td>
<td>8.0</td>
<td>0.757576</td>
<td>12.0</td>
<td>4.0</td>
<td>-0.151515</td>
<td>4.0</td>
<td>-6.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:53.187040Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:53.185911Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:59.298850Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:59.297541Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:53.186971Z&quot;}" data-trusted="true" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppress all warnings</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace infinite values with NaN</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features.replace([np.inf, <span class="op">-</span>np.inf], np.nan, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get numerical features</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>numerical_features <span class="op">=</span> df_historic_tourney_features.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of rows and columns for subplots</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>num_features <span class="op">=</span> <span class="bu">len</span>(numerical_features)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>num_rows <span class="op">=</span> math.ceil(num_features <span class="op">/</span> num_cols)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, num_rows <span class="op">*</span> <span class="dv">5</span>))</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(numerical_features):</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    plt.subplot(num_rows, num_cols, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    sns.histplot(df_historic_tourney_features[col], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    plt.title(col)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basketball-bracket-forecasting-2024ml_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="baseline---higher-seed-wins" class="level1">
<h1>Baseline - Higher Seed Wins</h1>
<p>To do this we will simply score the accuracy on historic tournaments assuming the higher seed always wins.</p>
<div id="cell-30" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:59.300842Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:59.300437Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:59.312652Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:59.310809Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:59.300809Z&quot;}" data-trusted="true" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features[<span class="st">"BaselinePred"</span>] <span class="op">=</span> (</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    df_historic_tourney_features[<span class="st">"ChalkSeed"</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span> df_historic_tourney_features[<span class="st">"OppChalkSeed"</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>df_historic_tourney_features.loc[</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    df_historic_tourney_features[<span class="st">"ChalkSeed"</span>]</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">==</span> df_historic_tourney_features[<span class="st">"OppChalkSeed"</span>],</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BaselinePred"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> (</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    df_historic_tourney_features[<span class="st">"WinPercentage"</span>]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">&gt;</span> df_historic_tourney_features[<span class="st">"OppWinPercentage"</span>]</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-31" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:59.315003Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:59.314608Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:38:59.865507Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:38:59.864157Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:59.314966Z&quot;}" data-trusted="true" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, log_loss</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>cv_scores_baseline <span class="op">=</span> []</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> season <span class="kw">in</span> df_historic_tourney_features[<span class="st">"Season"</span>].unique():</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> df_historic_tourney_features.query(<span class="st">"Season == @season"</span>)[</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BaselinePred"</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    ].astype(<span class="st">"int"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_historic_tourney_features.query(<span class="st">"Season == @season"</span>)[<span class="st">"Win"</span>]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> accuracy_score(y, pred)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    score_ll <span class="op">=</span> log_loss(y, pred)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    cv_scores_baseline.append(score)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Holdout season </span><span class="sc">{</span>season<span class="sc">}</span><span class="ss"> - Accuracy </span><span class="sc">{</span>score<span class="sc">:0.4f}</span><span class="ss"> Log Loss </span><span class="sc">{</span>score_ll<span class="sc">:0.4f}</span><span class="ss">"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Baseline accuracy </span><span class="sc">{</span>np<span class="sc">.</span>mean(cv_scores_baseline)<span class="sc">:0.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Holdout season 1985 - Accuracy 0.7143 Log Loss 10.2982
Holdout season 1986 - Accuracy 0.7143 Log Loss 10.2982
Holdout season 1987 - Accuracy 0.6984 Log Loss 10.8703
Holdout season 1988 - Accuracy 0.7143 Log Loss 10.2982
Holdout season 1989 - Accuracy 0.6667 Log Loss 12.0146
Holdout season 1990 - Accuracy 0.6825 Log Loss 11.4424
Holdout season 1991 - Accuracy 0.7460 Log Loss 9.1539
Holdout season 1992 - Accuracy 0.7619 Log Loss 8.5818
Holdout season 1993 - Accuracy 0.7937 Log Loss 7.4376
Holdout season 1994 - Accuracy 0.7143 Log Loss 10.2982
Holdout season 1995 - Accuracy 0.7619 Log Loss 8.5818
Holdout season 1996 - Accuracy 0.7460 Log Loss 9.1539
Holdout season 1997 - Accuracy 0.7302 Log Loss 9.7261
Holdout season 1998 - Accuracy 0.7143 Log Loss 10.2982
Holdout season 1999 - Accuracy 0.7222 Log Loss 10.0121
Holdout season 2000 - Accuracy 0.7302 Log Loss 9.7261
Holdout season 2001 - Accuracy 0.7047 Log Loss 10.6428
Holdout season 2002 - Accuracy 0.7480 Log Loss 9.0819
Holdout season 2003 - Accuracy 0.7402 Log Loss 9.3657
Holdout season 2004 - Accuracy 0.7244 Log Loss 9.9333
Holdout season 2005 - Accuracy 0.7165 Log Loss 10.2171
Holdout season 2006 - Accuracy 0.7480 Log Loss 9.0819
Holdout season 2007 - Accuracy 0.7717 Log Loss 8.2304
Holdout season 2008 - Accuracy 0.8031 Log Loss 7.0952
Holdout season 2009 - Accuracy 0.7402 Log Loss 9.3657
Holdout season 2010 - Accuracy 0.7402 Log Loss 9.3657
Holdout season 2011 - Accuracy 0.7000 Log Loss 10.8131
Holdout season 2012 - Accuracy 0.7923 Log Loss 7.4860
Holdout season 2013 - Accuracy 0.7154 Log Loss 10.2586
Holdout season 2014 - Accuracy 0.7000 Log Loss 10.8131
Holdout season 2015 - Accuracy 0.7923 Log Loss 7.4860
Holdout season 2016 - Accuracy 0.6846 Log Loss 11.3676
Holdout season 2017 - Accuracy 0.7769 Log Loss 8.0405
Holdout season 2018 - Accuracy 0.7000 Log Loss 10.8131
Holdout season 2019 - Accuracy 0.7538 Log Loss 8.8723
Holdout season 2021 - Accuracy 0.7519 Log Loss 8.9411
Holdout season 2022 - Accuracy 0.7015 Log Loss 10.7593
Holdout season 2023 - Accuracy 0.7164 Log Loss 10.2213
Baseline accuracy 0.7325</code></pre>
</div>
</div>
</section>
<section id="xgboost-model" class="level1">
<h1>XGBoost Model</h1>
<div id="cell-33" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:38:59.867416Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:38:59.867061Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:22.226128Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:22.224910Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:38:59.867385Z&quot;}" data-trusted="true" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>FEATURES <span class="op">=</span> [</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">"WinPercentage"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MedianScoreDiff"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ChalkSeed"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">"OppWinPercentage"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"OppMedianScoreDiff"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"OppChalkSeed"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"WinPctDiff"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ChalkSeedDiff"</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>TARGET <span class="op">=</span> <span class="st">"Win"</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_historic_tourney_features[FEATURES]</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_historic_tourney_features[TARGET]</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> df_historic_tourney_features[<span class="st">"Season"</span>]</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>seasons <span class="op">=</span> df_historic_tourney_features[<span class="st">"Season"</span>].unique()</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup cross-validation</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>gkf <span class="op">=</span> GroupKFold(n_splits<span class="op">=</span>df_historic_tourney_features[<span class="st">"Season"</span>].nunique())</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> []</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> []</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>season_idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> train_index, test_index <span class="kw">in</span> gkf.split(X, y, groups):</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    X_train, X_test <span class="op">=</span> X.iloc[train_index], X.iloc[test_index]</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    y_train, y_test <span class="op">=</span> y.iloc[train_index], y.iloc[test_index]</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare the model</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> xgb.XGBRegressor(</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">"logloss"</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>        n_estimators<span class="op">=</span><span class="dv">1_000</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>        learning_rate<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    holdout_season <span class="op">=</span> seasons[season_idx]</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Holdout Season: </span><span class="sc">{</span>holdout_season<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the model</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train, eval_set<span class="op">=</span>[(X_test, y_test)], verbose<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict on the test set</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    score_ll <span class="op">=</span> log_loss(y_test, y_pred)</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> y_pred <span class="op">&gt;</span> <span class="fl">0.5</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate the model</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    cv_results.append(accuracy)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>    season_idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Season </span><span class="sc">{</span>holdout_season<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>score_ll<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    models.append(model)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the average accuracy across all folds</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Average CV Accuracy:"</span>, np.mean(cv_results))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Holdout Season: 1985
[0] validation_0-logloss:0.69289
[100]   validation_0-logloss:0.66959
[200]   validation_0-logloss:0.65069
[300]   validation_0-logloss:0.63538
[400]   validation_0-logloss:0.62238
[500]   validation_0-logloss:0.61101
[600]   validation_0-logloss:0.60165
[700]   validation_0-logloss:0.59384
[800]   validation_0-logloss:0.58727
[900]   validation_0-logloss:0.58168
[999]   validation_0-logloss:0.57783
Season 1985: 0.7388059701492538 0.5778297953897061
Holdout Season: 1986
[0] validation_0-logloss:0.69288
[100]   validation_0-logloss:0.66882
[200]   validation_0-logloss:0.64906
[300]   validation_0-logloss:0.63319
[400]   validation_0-logloss:0.61992
[500]   validation_0-logloss:0.60787
[600]   validation_0-logloss:0.59805
[700]   validation_0-logloss:0.59025
[800]   validation_0-logloss:0.58413
[900]   validation_0-logloss:0.57886
[999]   validation_0-logloss:0.57464
Season 1986: 0.6902985074626866 0.5746410916790947
Holdout Season: 1987
[0] validation_0-logloss:0.69279
[100]   validation_0-logloss:0.65966
[200]   validation_0-logloss:0.63105
[300]   validation_0-logloss:0.60721
[400]   validation_0-logloss:0.58759
[500]   validation_0-logloss:0.57118
[600]   validation_0-logloss:0.55699
[700]   validation_0-logloss:0.54410
[800]   validation_0-logloss:0.53302
[900]   validation_0-logloss:0.52317
[999]   validation_0-logloss:0.51405
Season 1987: 0.75 0.5140454237560299
Holdout Season: 1988
[0] validation_0-logloss:0.69285
[100]   validation_0-logloss:0.66623
[200]   validation_0-logloss:0.64427
[300]   validation_0-logloss:0.62591
[400]   validation_0-logloss:0.61106
[500]   validation_0-logloss:0.59889
[600]   validation_0-logloss:0.58833
[700]   validation_0-logloss:0.57878
[800]   validation_0-logloss:0.57083
[900]   validation_0-logloss:0.56448
[999]   validation_0-logloss:0.55938
Season 1988: 0.7038461538461539 0.5593773261339369
Holdout Season: 1989
[0] validation_0-logloss:0.69280
[100]   validation_0-logloss:0.66095
[200]   validation_0-logloss:0.63427
[300]   validation_0-logloss:0.61216
[400]   validation_0-logloss:0.59319
[500]   validation_0-logloss:0.57735
[600]   validation_0-logloss:0.56368
[700]   validation_0-logloss:0.55191
[800]   validation_0-logloss:0.54149
[900]   validation_0-logloss:0.53248
[999]   validation_0-logloss:0.52479
Season 1989: 0.7884615384615384 0.5247887917788466
Holdout Season: 1990
[0] validation_0-logloss:0.69287
[100]   validation_0-logloss:0.66713
[200]   validation_0-logloss:0.64599
[300]   validation_0-logloss:0.62820
[400]   validation_0-logloss:0.61317
[500]   validation_0-logloss:0.60001
[600]   validation_0-logloss:0.58916
[700]   validation_0-logloss:0.58034
[800]   validation_0-logloss:0.57328
[900]   validation_0-logloss:0.56775
[999]   validation_0-logloss:0.56280
Season 1990: 0.7269230769230769 0.5628005594382917
Holdout Season: 1991
[0] validation_0-logloss:0.69279
[100]   validation_0-logloss:0.66054
[200]   validation_0-logloss:0.63394
[300]   validation_0-logloss:0.61099
[400]   validation_0-logloss:0.59190
[500]   validation_0-logloss:0.57585
[600]   validation_0-logloss:0.56179
[700]   validation_0-logloss:0.54953
[800]   validation_0-logloss:0.53909
[900]   validation_0-logloss:0.52938
[999]   validation_0-logloss:0.52094
Season 1991: 0.7807692307692308 0.5209394005663719
Holdout Season: 1992
[0] validation_0-logloss:0.69286
[100]   validation_0-logloss:0.66644
[200]   validation_0-logloss:0.64507
[300]   validation_0-logloss:0.62768
[400]   validation_0-logloss:0.61345
[500]   validation_0-logloss:0.60177
[600]   validation_0-logloss:0.59163
[700]   validation_0-logloss:0.58264
[800]   validation_0-logloss:0.57539
[900]   validation_0-logloss:0.56918
[999]   validation_0-logloss:0.56388
Season 1992: 0.6961538461538461 0.5638759436656668
Holdout Season: 1993
[0] validation_0-logloss:0.69286
[100]   validation_0-logloss:0.66692
[200]   validation_0-logloss:0.64527
[300]   validation_0-logloss:0.62694
[400]   validation_0-logloss:0.61169
[500]   validation_0-logloss:0.59876
[600]   validation_0-logloss:0.58816
[700]   validation_0-logloss:0.57937
[800]   validation_0-logloss:0.57203
[900]   validation_0-logloss:0.56525
[999]   validation_0-logloss:0.55973
Season 1993: 0.7038461538461539 0.5597309496798991
Holdout Season: 1994
[0] validation_0-logloss:0.69284
[100]   validation_0-logloss:0.66468
[200]   validation_0-logloss:0.63918
[300]   validation_0-logloss:0.61844
[400]   validation_0-logloss:0.60206
[500]   validation_0-logloss:0.58784
[600]   validation_0-logloss:0.57519
[700]   validation_0-logloss:0.56416
[800]   validation_0-logloss:0.55484
[900]   validation_0-logloss:0.54798
[999]   validation_0-logloss:0.54230
Season 1994: 0.75 0.5423035564199855
Holdout Season: 1995
[0] validation_0-logloss:0.69284
[100]   validation_0-logloss:0.66487
[200]   validation_0-logloss:0.64208
[300]   validation_0-logloss:0.62291
[400]   validation_0-logloss:0.60702
[500]   validation_0-logloss:0.59393
[600]   validation_0-logloss:0.58276
[700]   validation_0-logloss:0.57300
[800]   validation_0-logloss:0.56453
[900]   validation_0-logloss:0.55728
[999]   validation_0-logloss:0.55142
Season 1995: 0.7038461538461539 0.5514155650375784
Holdout Season: 1996
[0] validation_0-logloss:0.69286
[100]   validation_0-logloss:0.66706
[200]   validation_0-logloss:0.64582
[300]   validation_0-logloss:0.62855
[400]   validation_0-logloss:0.61431
[500]   validation_0-logloss:0.60184
[600]   validation_0-logloss:0.59106
[700]   validation_0-logloss:0.58220
[800]   validation_0-logloss:0.57470
[900]   validation_0-logloss:0.56827
[999]   validation_0-logloss:0.56252
Season 1996: 0.748062015503876 0.5625201829225002
Holdout Season: 1997
[0] validation_0-logloss:0.69281
[100]   validation_0-logloss:0.66213
[200]   validation_0-logloss:0.63632
[300]   validation_0-logloss:0.61529
[400]   validation_0-logloss:0.59747
[500]   validation_0-logloss:0.58238
[600]   validation_0-logloss:0.56959
[700]   validation_0-logloss:0.55879
[800]   validation_0-logloss:0.54948
[900]   validation_0-logloss:0.54136
[999]   validation_0-logloss:0.53445
Season 1997: 0.6968503937007874 0.5344523644145192
Holdout Season: 1998
[0] validation_0-logloss:0.69283
[100]   validation_0-logloss:0.66432
[200]   validation_0-logloss:0.64074
[300]   validation_0-logloss:0.62166
[400]   validation_0-logloss:0.60571
[500]   validation_0-logloss:0.59174
[600]   validation_0-logloss:0.57976
[700]   validation_0-logloss:0.57015
[800]   validation_0-logloss:0.56236
[900]   validation_0-logloss:0.55623
[999]   validation_0-logloss:0.55118
Season 1998: 0.7007874015748031 0.5511808710089903
Holdout Season: 1999
[0] validation_0-logloss:0.69283
[100]   validation_0-logloss:0.66377
[200]   validation_0-logloss:0.63985
[300]   validation_0-logloss:0.61951
[400]   validation_0-logloss:0.60174
[500]   validation_0-logloss:0.58692
[600]   validation_0-logloss:0.57416
[700]   validation_0-logloss:0.56353
[800]   validation_0-logloss:0.55441
[900]   validation_0-logloss:0.54638
[999]   validation_0-logloss:0.53948
Season 1999: 0.7598425196850394 0.5394789986657479
Holdout Season: 2000
[0] validation_0-logloss:0.69282
[100]   validation_0-logloss:0.66268
[200]   validation_0-logloss:0.63775
[300]   validation_0-logloss:0.61673
[400]   validation_0-logloss:0.59911
[500]   validation_0-logloss:0.58420
[600]   validation_0-logloss:0.57191
[700]   validation_0-logloss:0.56153
[800]   validation_0-logloss:0.55283
[900]   validation_0-logloss:0.54518
[999]   validation_0-logloss:0.53916
Season 2000: 0.7480314960629921 0.5391647286090452
Holdout Season: 2001
[0] validation_0-logloss:0.69281
[100]   validation_0-logloss:0.66195
[200]   validation_0-logloss:0.63569
[300]   validation_0-logloss:0.61374
[400]   validation_0-logloss:0.59482
[500]   validation_0-logloss:0.57860
[600]   validation_0-logloss:0.56502
[700]   validation_0-logloss:0.55295
[800]   validation_0-logloss:0.54328
[900]   validation_0-logloss:0.53569
[999]   validation_0-logloss:0.52856
Season 2001: 0.7362204724409449 0.5285587446199357
Holdout Season: 2002
[0] validation_0-logloss:0.69282
[100]   validation_0-logloss:0.66278
[200]   validation_0-logloss:0.63832
[300]   validation_0-logloss:0.61846
[400]   validation_0-logloss:0.60142
[500]   validation_0-logloss:0.58682
[600]   validation_0-logloss:0.57428
[700]   validation_0-logloss:0.56378
[800]   validation_0-logloss:0.55461
[900]   validation_0-logloss:0.54673
[999]   validation_0-logloss:0.53948
Season 2002: 0.7598425196850394 0.5394769853566181
Holdout Season: 2003
[0] validation_0-logloss:0.69278
[100]   validation_0-logloss:0.65820
[200]   validation_0-logloss:0.62854
[300]   validation_0-logloss:0.60321
[400]   validation_0-logloss:0.58185
[500]   validation_0-logloss:0.56368
[600]   validation_0-logloss:0.54842
[700]   validation_0-logloss:0.53497
[800]   validation_0-logloss:0.52316
[900]   validation_0-logloss:0.51282
[999]   validation_0-logloss:0.50337
Season 2003: 0.8110236220472441 0.5033689635420715
Holdout Season: 2004
[0] validation_0-logloss:0.69279
[100]   validation_0-logloss:0.66004
[200]   validation_0-logloss:0.63298
[300]   validation_0-logloss:0.61002
[400]   validation_0-logloss:0.59091
[500]   validation_0-logloss:0.57495
[600]   validation_0-logloss:0.56084
[700]   validation_0-logloss:0.54809
[800]   validation_0-logloss:0.53646
[900]   validation_0-logloss:0.52657
[999]   validation_0-logloss:0.51806
Season 2004: 0.7598425196850394 0.518058388778077
Holdout Season: 2005
[0] validation_0-logloss:0.69285
[100]   validation_0-logloss:0.66593
[200]   validation_0-logloss:0.64316
[300]   validation_0-logloss:0.62386
[400]   validation_0-logloss:0.60806
[500]   validation_0-logloss:0.59532
[600]   validation_0-logloss:0.58458
[700]   validation_0-logloss:0.57532
[800]   validation_0-logloss:0.56777
[900]   validation_0-logloss:0.56184
[999]   validation_0-logloss:0.55686
Season 2005: 0.7204724409448819 0.5568630854801879
Holdout Season: 2006
[0] validation_0-logloss:0.69279
[100]   validation_0-logloss:0.66073
[200]   validation_0-logloss:0.63402
[300]   validation_0-logloss:0.61214
[400]   validation_0-logloss:0.59401
[500]   validation_0-logloss:0.57845
[600]   validation_0-logloss:0.56532
[700]   validation_0-logloss:0.55379
[800]   validation_0-logloss:0.54412
[900]   validation_0-logloss:0.53580
[999]   validation_0-logloss:0.52888
Season 2006: 0.7834645669291339 0.5288818500432665
Holdout Season: 2007
[0] validation_0-logloss:0.69280
[100]   validation_0-logloss:0.66140
[200]   validation_0-logloss:0.63545
[300]   validation_0-logloss:0.61412
[400]   validation_0-logloss:0.59582
[500]   validation_0-logloss:0.58045
[600]   validation_0-logloss:0.56727
[700]   validation_0-logloss:0.55605
[800]   validation_0-logloss:0.54700
[900]   validation_0-logloss:0.53899
[999]   validation_0-logloss:0.53207
Season 2007: 0.7301587301587301 0.5320677444183068
Holdout Season: 2008
[0] validation_0-logloss:0.69282
[100]   validation_0-logloss:0.66283
[200]   validation_0-logloss:0.63764
[300]   validation_0-logloss:0.61655
[400]   validation_0-logloss:0.59906
[500]   validation_0-logloss:0.58414
[600]   validation_0-logloss:0.57135
[700]   validation_0-logloss:0.56081
[800]   validation_0-logloss:0.55198
[900]   validation_0-logloss:0.54486
[999]   validation_0-logloss:0.53912
Season 2008: 0.7063492063492064 0.5391169694796966
Holdout Season: 2009
[0] validation_0-logloss:0.69285
[100]   validation_0-logloss:0.66541
[200]   validation_0-logloss:0.64289
[300]   validation_0-logloss:0.62259
[400]   validation_0-logloss:0.60512
[500]   validation_0-logloss:0.59025
[600]   validation_0-logloss:0.57842
[700]   validation_0-logloss:0.56846
[800]   validation_0-logloss:0.55988
[900]   validation_0-logloss:0.55266
[999]   validation_0-logloss:0.54624
Season 2009: 0.7341269841269841 0.5462413883044884
Holdout Season: 2010
[0] validation_0-logloss:0.69287
[100]   validation_0-logloss:0.66895
[200]   validation_0-logloss:0.64925
[300]   validation_0-logloss:0.63285
[400]   validation_0-logloss:0.61851
[500]   validation_0-logloss:0.60678
[600]   validation_0-logloss:0.59829
[700]   validation_0-logloss:0.59128
[800]   validation_0-logloss:0.58547
[900]   validation_0-logloss:0.58057
[999]   validation_0-logloss:0.57621
Season 2010: 0.746031746031746 0.5762088515730862
Holdout Season: 2011
[0] validation_0-logloss:0.69287
[100]   validation_0-logloss:0.66799
[200]   validation_0-logloss:0.64904
[300]   validation_0-logloss:0.63373
[400]   validation_0-logloss:0.62165
[500]   validation_0-logloss:0.61168
[600]   validation_0-logloss:0.60233
[700]   validation_0-logloss:0.59461
[800]   validation_0-logloss:0.58855
[900]   validation_0-logloss:0.58447
[999]   validation_0-logloss:0.58129
Season 2011: 0.7063492063492064 0.5812932656654312
Holdout Season: 2012
[0] validation_0-logloss:0.69289
[100]   validation_0-logloss:0.66963
[200]   validation_0-logloss:0.65096
[300]   validation_0-logloss:0.63522
[400]   validation_0-logloss:0.62203
[500]   validation_0-logloss:0.61131
[600]   validation_0-logloss:0.60321
[700]   validation_0-logloss:0.59699
[800]   validation_0-logloss:0.59160
[900]   validation_0-logloss:0.58604
[999]   validation_0-logloss:0.58108
Season 2012: 0.6825396825396826 0.5810827664532549
Holdout Season: 2013
[0] validation_0-logloss:0.69287
[100]   validation_0-logloss:0.66859
[200]   validation_0-logloss:0.64898
[300]   validation_0-logloss:0.63316
[400]   validation_0-logloss:0.61976
[500]   validation_0-logloss:0.60907
[600]   validation_0-logloss:0.60078
[700]   validation_0-logloss:0.59385
[800]   validation_0-logloss:0.58772
[900]   validation_0-logloss:0.58348
[999]   validation_0-logloss:0.58025
Season 2013: 0.6904761904761905 0.5802509797933194
Holdout Season: 2014
[0] validation_0-logloss:0.69287
[100]   validation_0-logloss:0.66770
[200]   validation_0-logloss:0.64557
[300]   validation_0-logloss:0.62656
[400]   validation_0-logloss:0.61011
[500]   validation_0-logloss:0.59621
[600]   validation_0-logloss:0.58392
[700]   validation_0-logloss:0.57417
[800]   validation_0-logloss:0.56614
[900]   validation_0-logloss:0.55869
[999]   validation_0-logloss:0.55304
Season 2014: 0.7142857142857143 0.553043633254014
Holdout Season: 2015
[0] validation_0-logloss:0.69291
[100]   validation_0-logloss:0.67182
[200]   validation_0-logloss:0.65480
[300]   validation_0-logloss:0.64066
[400]   validation_0-logloss:0.62913
[500]   validation_0-logloss:0.61952
[600]   validation_0-logloss:0.61138
[700]   validation_0-logloss:0.60411
[800]   validation_0-logloss:0.59840
[900]   validation_0-logloss:0.59297
[999]   validation_0-logloss:0.58755
Season 2015: 0.6666666666666666 0.5875460362566335
Holdout Season: 2016
[0] validation_0-logloss:0.69285
[100]   validation_0-logloss:0.66582
[200]   validation_0-logloss:0.64238
[300]   validation_0-logloss:0.62351
[400]   validation_0-logloss:0.60794
[500]   validation_0-logloss:0.59474
[600]   validation_0-logloss:0.58378
[700]   validation_0-logloss:0.57469
[800]   validation_0-logloss:0.56706
[900]   validation_0-logloss:0.55932
[999]   validation_0-logloss:0.55255
Season 2016: 0.7698412698412699 0.5525456201369173
Holdout Season: 2017
[0] validation_0-logloss:0.69288
[100]   validation_0-logloss:0.66787
[200]   validation_0-logloss:0.64759
[300]   validation_0-logloss:0.62961
[400]   validation_0-logloss:0.61464
[500]   validation_0-logloss:0.60223
[600]   validation_0-logloss:0.59172
[700]   validation_0-logloss:0.58283
[800]   validation_0-logloss:0.57539
[900]   validation_0-logloss:0.56904
[999]   validation_0-logloss:0.56344
Season 2017: 0.7698412698412699 0.5634443193271796
Holdout Season: 2018
[0] validation_0-logloss:0.69281
[100]   validation_0-logloss:0.66275
[200]   validation_0-logloss:0.63768
[300]   validation_0-logloss:0.61566
[400]   validation_0-logloss:0.59696
[500]   validation_0-logloss:0.58147
[600]   validation_0-logloss:0.56827
[700]   validation_0-logloss:0.55691
[800]   validation_0-logloss:0.54721
[900]   validation_0-logloss:0.53843
[999]   validation_0-logloss:0.53049
Season 2018: 0.7936507936507936 0.530490176309942
Holdout Season: 2019
[0] validation_0-logloss:0.69286
[100]   validation_0-logloss:0.66659
[200]   validation_0-logloss:0.64485
[300]   validation_0-logloss:0.62537
[400]   validation_0-logloss:0.60911
[500]   validation_0-logloss:0.59551
[600]   validation_0-logloss:0.58377
[700]   validation_0-logloss:0.57349
[800]   validation_0-logloss:0.56437
[900]   validation_0-logloss:0.55681
[999]   validation_0-logloss:0.55022
Season 2019: 0.7301587301587301 0.5502209399838572
Holdout Season: 2021
[0] validation_0-logloss:0.69285
[100]   validation_0-logloss:0.66611
[200]   validation_0-logloss:0.64414
[300]   validation_0-logloss:0.62468
[400]   validation_0-logloss:0.60717
[500]   validation_0-logloss:0.59322
[600]   validation_0-logloss:0.58191
[700]   validation_0-logloss:0.57141
[800]   validation_0-logloss:0.56251
[900]   validation_0-logloss:0.55529
[999]   validation_0-logloss:0.54939
Season 2021: 0.7936507936507936 0.5493942297502401
Holdout Season: 2022
[0] validation_0-logloss:0.69289
[100]   validation_0-logloss:0.66851
[200]   validation_0-logloss:0.64874
[300]   validation_0-logloss:0.63198
[400]   validation_0-logloss:0.61734
[500]   validation_0-logloss:0.60451
[600]   validation_0-logloss:0.59320
[700]   validation_0-logloss:0.58400
[800]   validation_0-logloss:0.57707
[900]   validation_0-logloss:0.57161
[999]   validation_0-logloss:0.56720
Season 2022: 0.7301587301587301 0.5671985749078063
Holdout Season: 2023
[0] validation_0-logloss:0.69288
[100]   validation_0-logloss:0.66923
[200]   validation_0-logloss:0.64961
[300]   validation_0-logloss:0.63407
[400]   validation_0-logloss:0.62084
[500]   validation_0-logloss:0.61033
[600]   validation_0-logloss:0.60186
[700]   validation_0-logloss:0.59503
[800]   validation_0-logloss:0.58943
[900]   validation_0-logloss:0.58486
[999]   validation_0-logloss:0.58053
Season 2023: 0.7142857142857143 0.5805315287572473
Average CV Accuracy: 0.7351568954812976</code></pre>
</div>
</div>
</section>
<section id="predict-on-test-set" class="level1">
<h1>Predict on Test Set</h1>
<p>Now that we’ve trained our models. We can use them to predict on our future data.</p>
<div id="cell-35" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:22.227938Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:22.227579Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:22.242250Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:22.240815Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:22.227906Z&quot;}" data-trusted="true" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>TEST_SEASON <span class="op">=</span> <span class="dv">2024</span>  <span class="co"># Change to 2024 when it comes out!</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>seeds_2024 <span class="op">=</span> pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"2024_tourney_seeds.csv"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>seeds_2024[<span class="st">"ChalkSeed"</span>] <span class="op">=</span> (</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    seeds_2024[<span class="st">"Seed"</span>].<span class="bu">str</span>.replace(<span class="st">"a"</span>, <span class="st">""</span>).<span class="bu">str</span>.replace(<span class="st">"b"</span>, <span class="st">""</span>).<span class="bu">str</span>[<span class="dv">1</span>:].astype(<span class="st">"int"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tourney-pairs" class="level1">
<h1>Tourney Pairs</h1>
<ul>
<li>We don’t know which teams will play each other in later rounds, so we create a tourney_pairs dataframe.</li>
<li>This dataframe has all possible combinations of games. We will use our model to predict these.</li>
</ul>
<div id="cell-37" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:22.244272Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:22.243862Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:22.300419Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:22.299289Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:22.244234Z&quot;}" data-trusted="true" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tourney_pairs <span class="op">=</span> (</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    seeds_2024.merge(seeds_2024, on<span class="op">=</span>[<span class="st">"Tournament"</span>], suffixes<span class="op">=</span>(<span class="st">""</span>, <span class="st">"Opp"</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    .assign(Season<span class="op">=</span>TEST_SEASON)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">"TeamID != TeamIDOpp"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"Tournament"</span>: <span class="st">"League"</span>})</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>tourney_pairs <span class="op">=</span> (</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    tourney_pairs.merge(</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        team_season_agg[</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamID"</span>, <span class="st">"WinPercentage"</span>, <span class="st">"MedianScoreDiff"</span>]</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        on<span class="op">=</span>[<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamID"</span>],</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        how<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        team_season_agg[</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamID"</span>, <span class="st">"WinPercentage"</span>, <span class="st">"MedianScoreDiff"</span>]</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        ].rename(</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"TeamID"</span>: <span class="st">"TeamIDOpp"</span>,</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WinPercentage"</span>: <span class="st">"OppWinPercentage"</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">"MedianScoreDiff"</span>: <span class="st">"OppMedianScoreDiff"</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        on<span class="op">=</span>[<span class="st">"Season"</span>, <span class="st">"League"</span>, <span class="st">"TeamIDOpp"</span>],</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"OppChalkSeed"</span>] <span class="op">=</span> (</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"SeedOpp"</span>]</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">"a"</span>, <span class="st">""</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>.replace(<span class="st">"b"</span>, <span class="st">""</span>)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">str</span>[<span class="dv">1</span>:]</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="st">"int"</span>)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-features-to-2024" class="level1">
<h1>Add Features to 2024</h1>
<div id="cell-39" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:22.302105Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:22.301781Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:22.315321Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:22.313902Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:22.302078Z&quot;}" data-trusted="true" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"BaselinePred"</span>] <span class="op">=</span> (</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"ChalkSeed"</span>] <span class="op">&lt;</span> tourney_pairs[<span class="st">"OppChalkSeed"</span>]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>tourney_pairs.loc[</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"ChalkSeed"</span>] <span class="op">==</span> tourney_pairs[<span class="st">"OppChalkSeed"</span>],</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BaselinePred"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> (</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"WinPercentage"</span>] <span class="op">&gt;</span> tourney_pairs[<span class="st">"OppWinPercentage"</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"WinPctDiff"</span>] <span class="op">=</span> (</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"WinPercentage"</span>] <span class="op">-</span> tourney_pairs[<span class="st">"OppWinPercentage"</span>]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"ChalkSeedDiff"</span>] <span class="op">=</span> (</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"ChalkSeed"</span>] <span class="op">-</span> tourney_pairs[<span class="st">"OppChalkSeed"</span>]</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"MedianScoreDiffDiff"</span>] <span class="op">=</span> (</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"MedianScoreDiff"</span>] <span class="op">-</span> tourney_pairs[<span class="st">"OppMedianScoreDiff"</span>]</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-40" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:22.322665Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:22.321524Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:22.345290Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:22.343714Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:22.322617Z&quot;}" data-trusted="true" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tourney_pairs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">League</th>
<th data-quarto-table-cell-role="th">Seed</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">ChalkSeed</th>
<th data-quarto-table-cell-role="th">SeedOpp</th>
<th data-quarto-table-cell-role="th">TeamIDOpp</th>
<th data-quarto-table-cell-role="th">ChalkSeedOpp</th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">WinPercentage</th>
<th data-quarto-table-cell-role="th">MedianScoreDiff</th>
<th data-quarto-table-cell-role="th">OppWinPercentage</th>
<th data-quarto-table-cell-role="th">OppMedianScoreDiff</th>
<th data-quarto-table-cell-role="th">OppChalkSeed</th>
<th data-quarto-table-cell-role="th">BaselinePred</th>
<th data-quarto-table-cell-role="th">WinPctDiff</th>
<th data-quarto-table-cell-role="th">ChalkSeedDiff</th>
<th data-quarto-table-cell-role="th">MedianScoreDiffDiff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>M</td>
<td>W01</td>
<td>1163</td>
<td>1</td>
<td>W02</td>
<td>1235</td>
<td>2</td>
<td>2024</td>
<td>0.911765</td>
<td>14.0</td>
<td>0.794118</td>
<td>10.0</td>
<td>2</td>
<td>True</td>
<td>0.117647</td>
<td>-1</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>M</td>
<td>W01</td>
<td>1163</td>
<td>1</td>
<td>W03</td>
<td>1228</td>
<td>3</td>
<td>2024</td>
<td>0.911765</td>
<td>14.0</td>
<td>0.764706</td>
<td>9.5</td>
<td>3</td>
<td>True</td>
<td>0.147059</td>
<td>-2</td>
<td>4.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>M</td>
<td>W01</td>
<td>1163</td>
<td>1</td>
<td>W04</td>
<td>1120</td>
<td>4</td>
<td>2024</td>
<td>0.911765</td>
<td>14.0</td>
<td>0.794118</td>
<td>17.0</td>
<td>4</td>
<td>True</td>
<td>0.117647</td>
<td>-3</td>
<td>-3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>M</td>
<td>W01</td>
<td>1163</td>
<td>1</td>
<td>W05</td>
<td>1361</td>
<td>5</td>
<td>2024</td>
<td>0.911765</td>
<td>14.0</td>
<td>0.687500</td>
<td>8.5</td>
<td>5</td>
<td>True</td>
<td>0.224265</td>
<td>-4</td>
<td>5.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>M</td>
<td>W01</td>
<td>1163</td>
<td>1</td>
<td>W06</td>
<td>1140</td>
<td>6</td>
<td>2024</td>
<td>0.911765</td>
<td>14.0</td>
<td>0.696970</td>
<td>9.0</td>
<td>6</td>
<td>True</td>
<td>0.214795</td>
<td>-5</td>
<td>5.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="create-predictions-and-aggregate" class="level1">
<h1>Create Predictions and Aggregate</h1>
<ul>
<li>Loop through each of the models we trained before and predict on the latest tourney seed data.</li>
</ul>
<div id="cell-42" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:22.347623Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:22.347137Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:25.865060Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:25.864062Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:22.347582Z&quot;}" data-trusted="true" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, model <span class="kw">in</span> <span class="bu">enumerate</span>(models):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="ss">f"pred_model</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> model.predict(tourney_pairs[FEATURES])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-43" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:25.867315Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:25.866742Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:25.897532Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:25.896096Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:25.867267Z&quot;}" data-trusted="true" data-execution_count="30">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"Pred"</span>] <span class="op">=</span> tourney_pairs[</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    [f <span class="cf">for</span> f <span class="kw">in</span> tourney_pairs.columns <span class="cf">if</span> <span class="st">"model"</span> <span class="kw">in</span> f]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>tourney_pairs[<span class="st">"ID"</span>] <span class="op">=</span> (</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    tourney_pairs[<span class="st">"Season"</span>].astype(<span class="st">"str"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">"_"</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> tourney_pairs[<span class="st">"TeamID"</span>].astype(<span class="st">"str"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">"_"</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> tourney_pairs[<span class="st">"TeamIDOpp"</span>].astype(<span class="st">"str"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> tourney_pairs.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulate-bracket" class="level1">
<h1>Simulate Bracket</h1>
<ul>
<li>Now we have probabilites for every possible combination of possible games in the tournament.</li>
<li>We want to convert this into a standard “bracket” format.</li>
<li>To do this we simulate each round and select the highest scored team.</li>
</ul>
<div id="cell-45" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:25.900195Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:25.899153Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:25.956224Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:25.954931Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:25.900153Z&quot;}" data-trusted="true" data-execution_count="31">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and filter data</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>round_slots <span class="op">=</span> pd.read_csv(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/kaggle/input/march-machine-learning-mania-2024/MNCAATourneySlots.csv"</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>round_slots <span class="op">=</span> round_slots[round_slots[<span class="st">"Season"</span>] <span class="op">==</span> <span class="dv">2024</span>]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>round_slots <span class="op">=</span> round_slots[</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    round_slots[<span class="st">"Slot"</span>].<span class="bu">str</span>.contains(<span class="st">"R"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># Filter out First Four</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> pd.read_csv(</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/kaggle/input/march-machine-learning-mania-2024/2024_tourney_seeds.csv"</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>seeds_m <span class="op">=</span> seeds[seeds[<span class="st">"Tournament"</span>] <span class="op">==</span> <span class="st">"M"</span>]</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>seeds_w <span class="op">=</span> seeds[seeds[<span class="st">"Tournament"</span>] <span class="op">==</span> <span class="st">"W"</span>]</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>preds[<span class="st">"ID"</span>] <span class="op">=</span> preds[<span class="st">"ID"</span>].<span class="bu">str</span>.split(<span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:25.957982Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:25.957662Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.011937Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.010472Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:25.957956Z&quot;}" data-trusted="true" data-execution_count="32">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_data(seeds, preds):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Function preparing the data for the simulation</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    seed_dict <span class="op">=</span> seeds.set_index(<span class="st">"Seed"</span>)[<span class="st">"TeamID"</span>].to_dict()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    inverted_seed_dict <span class="op">=</span> {value: key <span class="cf">for</span> key, value <span class="kw">in</span> seed_dict.items()}</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    probas_dict <span class="op">=</span> {}</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> teams, proba <span class="kw">in</span> <span class="bu">zip</span>(preds[<span class="st">"ID"</span>], preds[<span class="st">"Pred"</span>]):</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        team1, team2 <span class="op">=</span> teams[<span class="dv">1</span>], teams[<span class="dv">2</span>]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        probas_dict.setdefault(team1, {})[team2] <span class="op">=</span> proba</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        probas_dict.setdefault(team2, {})[team1] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> proba</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seed_dict, inverted_seed_dict, probas_dict</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate(round_slots, seeds, inverted_seeds, probas, sim<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    winners <span class="op">=</span> []</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    slots <span class="op">=</span> []</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> slot, strong, weak <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>        round_slots.Slot, round_slots.StrongSeed, round_slots.WeakSeed</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        team_1, team_2 <span class="op">=</span> seeds[strong], seeds[weak]</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the probability of team_1 winning</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        proba <span class="op">=</span> probas[<span class="bu">str</span>(team_1)][<span class="bu">str</span>(team_2)]</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> sim:</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Randomly determine the winner based on the probability</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>            winner <span class="op">=</span> np.random.choice([team_1, team_2], p<span class="op">=</span>[proba, <span class="dv">1</span> <span class="op">-</span> proba])</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Determine the winner based on the higher probability</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>            winner <span class="op">=</span> [team_1, team_2][np.argmax([proba, <span class="dv">1</span> <span class="op">-</span> proba])]</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the winner and corresponding slot to the lists</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>        winners.append(winner)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>        slots.append(slot)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>        seeds[slot] <span class="op">=</span> winner</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert winners to original seeds using the inverted_seeds dictionary</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [inverted_seeds[w] <span class="cf">for</span> w <span class="kw">in</span> winners], slots</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_simulation(brackets<span class="op">=</span><span class="dv">1</span>, seeds<span class="op">=</span><span class="va">None</span>, preds<span class="op">=</span><span class="va">None</span>, round_slots<span class="op">=</span><span class="va">None</span>, sim<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get relevant data for the simulation</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>    seed_dict, inverted_seed_dict, probas_dict <span class="op">=</span> prepare_data(seeds, preds)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lists to store simulation results</span></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>    bracket <span class="op">=</span> []</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    slots <span class="op">=</span> []</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate through the specified number of brackets</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">1</span>, brackets <span class="op">+</span> <span class="dv">1</span>)):</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Run single simulation</span></span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>        r, s <span class="op">=</span> simulate(round_slots, seed_dict, inverted_seed_dict, probas_dict, sim)</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update results</span></span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>        results.extend(r)</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>        bracket.extend([b] <span class="op">*</span> <span class="bu">len</span>(r))</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>        slots.extend(s)</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create final DataFrame</span></span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>    result_df <span class="op">=</span> pd.DataFrame({<span class="st">"Bracket"</span>: bracket, <span class="st">"Slot"</span>: slots, <span class="st">"Team"</span>: results})</span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result_df</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>n_brackets <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>result_m <span class="op">=</span> run_simulation(</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>    brackets<span class="op">=</span>n_brackets, seeds<span class="op">=</span>seeds_m, preds<span class="op">=</span>preds, round_slots<span class="op">=</span>round_slots, sim<span class="op">=</span><span class="va">False</span></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>result_m[<span class="st">"Tournament"</span>] <span class="op">=</span> <span class="st">"M"</span></span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>result_w <span class="op">=</span> run_simulation(</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>    brackets<span class="op">=</span>n_brackets, seeds<span class="op">=</span>seeds_w, preds<span class="op">=</span>preds, round_slots<span class="op">=</span>round_slots, sim<span class="op">=</span><span class="va">False</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>result_w[<span class="st">"Tournament"</span>] <span class="op">=</span> <span class="st">"W"</span></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> pd.concat([result_m, result_w])</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> submission.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>submission.index.names <span class="op">=</span> [<span class="st">"RowId"</span>]</span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> submission.reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 1/1 [00:00&lt;00:00, 653.73it/s]
100%|██████████| 1/1 [00:00&lt;00:00, 601.85it/s]</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.013854Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.013493Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.033657Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.031228Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.013825Z&quot;}" data-trusted="true" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ss <span class="op">=</span> pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"sample_submission.csv"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>submission[ss.columns] <span class="op">=</span> submission[ss.columns]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>submission[ss.columns].to_csv(<span class="st">"submission.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-48" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.036520Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.035364Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.119667Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.118328Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.036448Z&quot;}" data-trusted="true" data-execution_count="34">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>submission_with_names <span class="op">=</span> submission.rename(columns<span class="op">=</span>{<span class="st">"Team"</span>: <span class="st">"Seed"</span>}).merge(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    seeds, on<span class="op">=</span>[<span class="st">"Seed"</span>, <span class="st">"Tournament"</span>], how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>teams <span class="op">=</span> pd.concat(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"MTeams.csv"</span>).assign(Tournament<span class="op">=</span><span class="st">"M"</span>),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(DATA_PATH <span class="op">+</span> <span class="st">"WTeams.csv"</span>).assign(Tournament<span class="op">=</span><span class="st">"W"</span>),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>submission_with_names <span class="op">=</span> submission_with_names.merge(</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    teams[[<span class="st">"Tournament"</span>, <span class="st">"TeamID"</span>, <span class="st">"TeamName"</span>]], how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-49" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.121686Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.121278Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.129868Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.128398Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.121653Z&quot;}" data-trusted="true" data-execution_count="35">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>submission_with_names.to_csv(<span class="st">"submission_with_names.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.132310Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.131818Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.151679Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.150041Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.132269Z&quot;}" data-trusted="true" data-execution_count="36">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>submission_with_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">RowId</th>
<th data-quarto-table-cell-role="th">Bracket</th>
<th data-quarto-table-cell-role="th">Slot</th>
<th data-quarto-table-cell-role="th">Seed</th>
<th data-quarto-table-cell-role="th">Tournament</th>
<th data-quarto-table-cell-role="th">TeamID</th>
<th data-quarto-table-cell-role="th">TeamName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>R1W1</td>
<td>W01</td>
<td>M</td>
<td>1163</td>
<td>Connecticut</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>R1W2</td>
<td>W02</td>
<td>M</td>
<td>1235</td>
<td>Iowa St</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>1</td>
<td>R1W3</td>
<td>W03</td>
<td>M</td>
<td>1228</td>
<td>Illinois</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>1</td>
<td>R1W4</td>
<td>W04</td>
<td>M</td>
<td>1120</td>
<td>Auburn</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>1</td>
<td>R1W5</td>
<td>W05</td>
<td>M</td>
<td>1361</td>
<td>San Diego St</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">121</td>
<td>121</td>
<td>1</td>
<td>R4Y1</td>
<td>Y01</td>
<td>W</td>
<td>3234</td>
<td>Iowa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">122</td>
<td>122</td>
<td>1</td>
<td>R4Z1</td>
<td>Z03</td>
<td>W</td>
<td>3163</td>
<td>Connecticut</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">123</td>
<td>123</td>
<td>1</td>
<td>R5WX</td>
<td>W01</td>
<td>W</td>
<td>3376</td>
<td>South Carolina</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">124</td>
<td>124</td>
<td>1</td>
<td>R5YZ</td>
<td>Y01</td>
<td>W</td>
<td>3234</td>
<td>Iowa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">125</td>
<td>125</td>
<td>1</td>
<td>R6CH</td>
<td>W01</td>
<td>W</td>
<td>3376</td>
<td>South Carolina</td>
</tr>
</tbody>
</table>

<p>126 rows × 7 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-51" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.153675Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.153251Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.165607Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.164064Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.153637Z&quot;}" data-trusted="true" data-execution_count="37">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>output_file_path <span class="op">=</span> <span class="st">'/kaggle/working/submission_with_names.csv'</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>submission_with_names.to_csv(output_file_path, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-52" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.168252Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.167814Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.189527Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.188007Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.168213Z&quot;}" data-trusted="true" data-execution_count="38">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>men_teams <span class="op">=</span> submission_with_names[submission_with_names[<span class="st">'Tournament'</span>] <span class="op">==</span> <span class="st">'M'</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Regions: W, X, Y, Z</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>regions <span class="op">=</span> [<span class="st">'W'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>]</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary to hold the bracket mapping</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>bracket_mapping <span class="op">=</span> {region: {} <span class="cf">for</span> region <span class="kw">in</span> regions}</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Populate the bracket mapping</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> men_teams.iterrows():</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> row[<span class="st">'Seed'</span>][<span class="dv">0</span>]</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="bu">int</span>(row[<span class="st">'Seed'</span>][<span class="dv">1</span>:])</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    team_name <span class="op">=</span> row[<span class="st">'TeamName'</span>]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    bracket_mapping[region][seed] <span class="op">=</span> team_name</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>bracket_mapping</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>{'W': {1: 'Connecticut',
  2: 'Iowa St',
  3: 'Illinois',
  4: 'Auburn',
  5: 'San Diego St',
  6: 'BYU',
  7: 'Washington St',
  8: 'FL Atlantic'},
 'X': {1: 'North Carolina',
  2: 'Arizona',
  3: 'Baylor',
  4: 'Alabama',
  5: "St Mary's CA",
  6: 'Clemson',
  7: 'Dayton',
  8: 'Mississippi St'},
 'Y': {1: 'Purdue',
  2: 'Tennessee',
  3: 'Creighton',
  4: 'Kansas',
  5: 'Gonzaga',
  6: 'South Carolina',
  7: 'Texas',
  8: 'Utah St'},
 'Z': {1: 'Houston',
  2: 'Marquette',
  3: 'Kentucky',
  4: 'Duke',
  5: 'Wisconsin',
  6: 'Texas Tech',
  7: 'Florida',
  8: 'Nebraska'}}</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.191543Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.191145Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.202384Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.200916Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.191510Z&quot;}" data-trusted="true" data-execution_count="39">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_bracket(bracket_mapping):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> region, seeds <span class="kw">in</span> bracket_mapping.items():</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Region </span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seed <span class="kw">in</span> <span class="bu">sorted</span>(seeds.keys()):</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>seed<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>seeds[seed]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the bracket representation</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>print_bracket(bracket_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Region W:
  1: Connecticut
  2: Iowa St
  3: Illinois
  4: Auburn
  5: San Diego St
  6: BYU
  7: Washington St
  8: FL Atlantic

Region X:
  1: North Carolina
  2: Arizona
  3: Baylor
  4: Alabama
  5: St Mary's CA
  6: Clemson
  7: Dayton
  8: Mississippi St

Region Y:
  1: Purdue
  2: Tennessee
  3: Creighton
  4: Kansas
  5: Gonzaga
  6: South Carolina
  7: Texas
  8: Utah St

Region Z:
  1: Houston
  2: Marquette
  3: Kentucky
  4: Duke
  5: Wisconsin
  6: Texas Tech
  7: Florida
  8: Nebraska
</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.204377Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.204012Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.224750Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.223354Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.204343Z&quot;}" data-trusted="true" data-execution_count="40">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>women_teams <span class="op">=</span> submission_with_names[submission_with_names[<span class="st">'Tournament'</span>] <span class="op">==</span> <span class="st">'w'</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Regions: W, X, Y, Z</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>regions <span class="op">=</span> [<span class="st">'W'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary to hold the bracket mapping</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>bracket_mapping <span class="op">=</span> {region: {} <span class="cf">for</span> region <span class="kw">in</span> regions}</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Populate the bracket mapping</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> men_teams.iterrows():</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> row[<span class="st">'Seed'</span>][<span class="dv">0</span>]</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="bu">int</span>(row[<span class="st">'Seed'</span>][<span class="dv">1</span>:])</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    team_name <span class="op">=</span> row[<span class="st">'TeamName'</span>]</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    bracket_mapping[region][seed] <span class="op">=</span> team_name</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>bracket_mapping</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>{'W': {1: 'Connecticut',
  2: 'Iowa St',
  3: 'Illinois',
  4: 'Auburn',
  5: 'San Diego St',
  6: 'BYU',
  7: 'Washington St',
  8: 'FL Atlantic'},
 'X': {1: 'North Carolina',
  2: 'Arizona',
  3: 'Baylor',
  4: 'Alabama',
  5: "St Mary's CA",
  6: 'Clemson',
  7: 'Dayton',
  8: 'Mississippi St'},
 'Y': {1: 'Purdue',
  2: 'Tennessee',
  3: 'Creighton',
  4: 'Kansas',
  5: 'Gonzaga',
  6: 'South Carolina',
  7: 'Texas',
  8: 'Utah St'},
 'Z': {1: 'Houston',
  2: 'Marquette',
  3: 'Kentucky',
  4: 'Duke',
  5: 'Wisconsin',
  6: 'Texas Tech',
  7: 'Florida',
  8: 'Nebraska'}}</code></pre>
</div>
</div>
<div id="cell-55" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-06-12T12:40:26.226810Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-06-12T12:40:26.226432Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-06-12T12:40:26.237500Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-06-12T12:40:26.236202Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-06-12T12:40:26.226779Z&quot;}" data-trusted="true" data-execution_count="41">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_bracket(bracket_mapping):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> region, seeds <span class="kw">in</span> bracket_mapping.items():</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Region </span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seed <span class="kw">in</span> <span class="bu">sorted</span>(seeds.keys()):</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>seed<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>seeds[seed]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the bracket representation</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>print_bracket(bracket_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Region W:
  1: Connecticut
  2: Iowa St
  3: Illinois
  4: Auburn
  5: San Diego St
  6: BYU
  7: Washington St
  8: FL Atlantic

Region X:
  1: North Carolina
  2: Arizona
  3: Baylor
  4: Alabama
  5: St Mary's CA
  6: Clemson
  7: Dayton
  8: Mississippi St

Region Y:
  1: Purdue
  2: Tennessee
  3: Creighton
  4: Kansas
  5: Gonzaga
  6: South Carolina
  7: Texas
  8: Utah St

Region Z:
  1: Houston
  2: Marquette
  3: Kentucky
  4: Duke
  5: Wisconsin
  6: Texas Tech
  7: Florida
  8: Nebraska
</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>